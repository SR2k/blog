<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="本文翻译自 raywenderlich.com 的 How to Use NSTouchBar on macOS，已咨询对方网站，可至多翻译 10 篇文章。各位若有英语阅读能力的话，还是先打赏然后去阅读英文原吧😉。综上，此翻译版本仅供参考，谢绝转载。    对了我跟着这个教程敲代码的时候发现文中所有的 @available(OSX 10.12.1, *) 其实应为 @available(OSX">
<meta name="keywords" content="翻译,Ray Wenderlich,macOS,Swift">
<meta property="og:type" content="article">
<meta property="og:title" content="【译】如何在 macOS 上使用 NSTouchBar">
<meta property="og:url" content="https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/index.html">
<meta property="og:site_name" content="SR2k">
<meta property="og:description" content="本文翻译自 raywenderlich.com 的 How to Use NSTouchBar on macOS，已咨询对方网站，可至多翻译 10 篇文章。各位若有英语阅读能力的话，还是先打赏然后去阅读英文原吧😉。综上，此翻译版本仅供参考，谢绝转载。    对了我跟着这个教程敲代码的时候发现文中所有的 @available(OSX 10.12.1, *) 其实应为 @available(OSX">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-52bd2e529f437384.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-f1e49c156d4e8aba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-1920310de9ddfda1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-1ad812514b33ca1d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-1c112d10fa6ba8b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-eb56c213cf6eb050.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-96245a90a25d22dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-88d35baba7596185.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-de1447818a28d7be.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-a7c5438cf524b6a1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-c9f44cf8bb30f2df.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2019-07-19T05:03:34.685Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【译】如何在 macOS 上使用 NSTouchBar">
<meta name="twitter:description" content="本文翻译自 raywenderlich.com 的 How to Use NSTouchBar on macOS，已咨询对方网站，可至多翻译 10 篇文章。各位若有英语阅读能力的话，还是先打赏然后去阅读英文原吧😉。综上，此翻译版本仅供参考，谢绝转载。    对了我跟着这个教程敲代码的时候发现文中所有的 @available(OSX 10.12.1, *) 其实应为 @available(OSX">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/5477931-52bd2e529f437384.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
    
    
        
          
              <link rel="shortcut icon" href="/blog/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/blog/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>【译】如何在 macOS 上使用 NSTouchBar</title>
    <!-- styles -->
    <link rel="stylesheet" href="/blog/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/blog/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/blog/">首页</a></li>
         
          <li><a href="/blog/archives/">归档</a></li>
         
          <li><a href="https://sr2k.top">简历</a></li>
         
          <li><a href="http://github.com/SR2k">项目</a></li>
         
          <li><a href="/blog/tags/">标签</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/blog/2018/01/12/JavaScript面向对象/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/blog/2017/09/25/译-macOS上的CoreGraphics入门教程/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&text=【译】如何在 macOS 上使用 NSTouchBar"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&title=【译】如何在 macOS 上使用 NSTouchBar"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&is_video=false&description=【译】如何在 macOS 上使用 NSTouchBar"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=【译】如何在 macOS 上使用 NSTouchBar&body=Check out this article: https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&title=【译】如何在 macOS 上使用 NSTouchBar"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&title=【译】如何在 macOS 上使用 NSTouchBar"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&title=【译】如何在 macOS 上使用 NSTouchBar"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&title=【译】如何在 macOS 上使用 NSTouchBar"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&name=【译】如何在 macOS 上使用 NSTouchBar&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Touch-Bar-是个啥？"><span class="toc-number">1.</span> <span class="toc-text">Touch Bar 是个啥？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#如何让你的-app-支持-Touch-Bar"><span class="toc-number">2.</span> <span class="toc-text">如何让你的 app 支持 Touch Bar</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#准备开始"><span class="toc-number">3.</span> <span class="toc-text">准备开始</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Text-Field-和-Scrubber"><span class="toc-number">4.</span> <span class="toc-text">Text Field 和 Scrubber</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Segmented-Control"><span class="toc-number">5.</span> <span class="toc-text">Segmented Control</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#彩色按钮"><span class="toc-number">6.</span> <span class="toc-text">彩色按钮</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#现在该做些啥？"><span class="toc-number">7.</span> <span class="toc-text">现在该做些啥？</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        【译】如何在 macOS 上使用 NSTouchBar
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">SR2k</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2017-10-09T16:01:11.000Z" itemprop="datePublished">2017-10-10</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/blog/tags/Ray-Wenderlich/">Ray Wenderlich</a>, <a class="tag-link" href="/blog/tags/Swift/">Swift</a>, <a class="tag-link" href="/blog/tags/macOS/">macOS</a>, <a class="tag-link" href="/blog/tags/翻译/">翻译</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <blockquote>
<p>本文翻译自 <a href="https://www.raywenderlich.com/" target="_blank" rel="noopener">raywenderlich.com</a> 的 <a href="https://www.raywenderlich.com/147118/use-nstouchbar-macos" target="_blank" rel="noopener">How to Use NSTouchBar on macOS</a>，已咨询对方网站，可至多翻译 10 篇文章。<br>各位若有英语阅读能力的话，还是<del>先打赏然后</del>去阅读英文原吧😉。<br>综上，此翻译版本仅供参考，<strong>谢绝转载</strong>。</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-52bd2e529f437384.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<blockquote>
<p>对了我跟着这个教程敲代码的时候发现文中所有的 <code>@available(OSX 10.12.1, *)</code> 其实应为 <code>@available(OSX 10.12.2, *)</code>，但是出于对原文的尊重没有修改，请各位注意～</p>
</blockquote>
<p>等了好久好久<del>终于等到今天</del>之后，Apple 终于发布了新款的 MacBook Pro，它最惹人瞩目的应该就是那块（小小的）触屏了吧。</p>
<p>新款设备用全新的 Touch Bar 替代了原有的功能键，它们可扩展、支持多点触控，更重要的是，Touch Bar 对开发者们完全开放，这意味着你的 macOS app 可以获得一种全新的交互方式。</p>
<p>如果你是一个 macOS 开发者，你一定很希望自己的 app 能够立刻使用上这项前沿科技。在这个教程中，我会将向你们展示如何使用全新的 <code>NSTouchBar</code> API 来为你的 macOS app 创建一个动态的 Touch Bar。</p>
<blockquote>
<p><strong>注意：</strong>这个教程需要 Xcode 8.1 或更高版本以及 macOS 10.12.1 (Build 16B2657) 或更高版本，否则的话你将无法运行 Touch Bar 模拟器。你可以在 <strong></strong> → <strong>关于本机</strong>里点击数字版本号来查看 build 版本。<br><img src="http://upload-images.jianshu.io/upload_images/5477931-f1e49c156d4e8aba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>如果你的版本不够，你可以在 <a href="https://support.apple.com/kb/dl1897" target="_blank" rel="noopener">Apple 的网站上</a> 下载。</p>
</blockquote>
<h1 id="Touch-Bar-是个啥？"><a href="#Touch-Bar-是个啥？" class="headerlink" title="Touch Bar 是个啥？"></a>Touch Bar 是个啥？</h1><p>如上文所述，Touch Bar 是一块安装在键盘上方的细长形的触摸屏，它允许用户使用一种全新的方式来与 app（以及 Mac）进行交互。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-1920310de9ddfda1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>在 Touch Bar 上有三个默认的部分：</p>
<ul>
<li><em>系统按钮</em>：根据运行的 app，这里将会显示一个系统级的按钮，比如 esc；</li>
<li><em>App 区域</em>：你的 app 可以控制的显示区域，也就是我们的主舞台；</li>
<li><em>控制条</em>：这里用于显示你熟悉的控制按钮，比如亮度、音量等。</li>
</ul>
<p>和其它许多 Apple 的新科技一样，Touch Bar 也拥有自己的《人机交互则例（Human Interface Guidelines）》，为了你的 app 和其它 Mac app 拥有统一的用户体验，你应当遵循这份则例。你可以<a href="https://developer.apple.com/library/content/documentation/UserExperience/Conceptual/OSXHIGuidelines/AbouttheTouchBar.html" target="_blank" rel="noopener">点击这里</a>阅读它。</p>
<p>概括说来，这份则例中比较重要的几点有：</p>
<ul>
<li><strong>App 中的某个功能不应该只能在 Touch Bar 中使用</strong>：即使部份用户还未升级到最新的硬件，你的 app 也应该尽量为他们提供一样的功能。如果你决定为 Touch Bar 加入某些功能，请确保这个功能也能在 app 的其他某处也可以访问到。另外 Touch Bar 是可以被用户禁用的，所以也别太指望你的用户能一直看到它；</li>
<li><strong>Touch Bar 是键盘的延伸，而不是一个显示屏</strong>：诚然，Touch Bar 是一个显示屏，但是它不是显示器的延伸，而是一个与 app 交互的窗口。你不应该在 Touch Bar 上用滚来滚去的内容或 blingbling 的警告打扰用户的视线；</li>
<li><strong>快速响应</strong>：用户在键盘上按下一个真实的按键时，按键会立即给予一个反馈（也就是被按下去了）。同理，用户在 Touch Bar 上按下一个虚拟按钮时，你也应该给他们提供即时的反馈。</li>
</ul>
<h1 id="如何让你的-app-支持-Touch-Bar"><a href="#如何让你的-app-支持-Touch-Bar" class="headerlink" title="如何让你的 app 支持 Touch Bar"></a>如何让你的 app 支持 Touch Bar</h1><p>要让你的 app 支持 Touch Bar，你需要使用 Apple 提供的两个类：<code>NSTouchBar</code> 和  <code>NSTouchBarItem</code>（当然还有他们的子类）。</p>
<p>某些 <code>NSTouchBarItem</code> 的子类提供了这些功能：</p>
<ul>
<li><strong>Slider</strong>：滑动调节某个值；</li>
<li><strong>Popover</strong>：把更多功能藏入一个二级菜单中；</li>
<li><strong>Color Picker</strong>：和名字一样，用来选取颜色的咯🤷‍♀️；</li>
<li><strong>Custom</strong>：这个子类是你的天下，你可以在它的里面塞入文本、按钮以及其他各种各样的控件。</li>
</ul>
<p>从文字大小颜色到图片内容，你可以随意自定义你的 item，从而为你的用户提供一个传统键盘无法提供的、更加牛×的交互方式，但是请时刻请谨记《人机交互则例》。现在我们要开始动工啦。</p>
<h1 id="准备开始"><a href="#准备开始" class="headerlink" title="准备开始"></a>准备开始</h1><p>在开始敲代码之前，请先<a href="https://koenig-media.raywenderlich.com/uploads/2016/10/TouchBar-Starter-2.zip" target="_blank" rel="noopener">点击这里</a>下载初始项目的源代码。</p>
<p>我们要编写的 app 是一个简单的旅行记录 app。打开初始项目，如果你的设备不支持 Touch Bar，请点击 Xcode 菜单栏上的 <strong>Window</strong> → <strong>Show Touch Bar</strong>，Touch Bar 的模拟器就会出现在屏幕上。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-1ad812514b33ca1d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>编译并运行你的 app，你将会看到 Touch Bar 上除了 esc 按钮和控制条以外空空如也。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-1c112d10fa6ba8b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-eb56c213cf6eb050.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>我们要做的第一步是告诉系统我们的 app 需要自定义 Touch Bar。打开 <strong>AppDelegate.swift</strong>，将这些代码添加到 <code>applicationDidFinishLaunching(_:)</code> 方法中：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">applicationDidFinishLaunching</span><span class="params">(<span class="number">_</span> aNotification: Notification)</span></span> &#123;</span><br><span class="line">  <span class="keyword">if</span> #available(<span class="type">OSX</span> <span class="number">10.12</span>.<span class="number">1</span>, *) &#123;</span><br><span class="line">    <span class="type">NSApplication</span>.shared().isAutomaticCustomizeTouchBarMenuItemEnabled = <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这些代码将会帮你搞定启用 Touch Bar 所需要的各种操作，（在写这篇文章的时候）Xcode 还没有 macOS 10.12.1 的配套 SDK，所以你需要在 Touch Bar 相关的代码周边添加 <code>#available(OS X 10.12.1, *)</code>，当然如果你忘了这件事，Xcode 会给你一个温馨的提醒😉。</p>
<p>打开 <strong>WindowController.swift</strong>，找到 <code>makeTouchBar()</code>，这个方法用于检测 <code>ViewController</code> 是否含有一个可以被返回的 Touch Bar，如果有，它会把这个 Touch Bar 返回给 <strong>Window</strong>，然后呈现给用户。现在，我们还没有创建 Touch Bar，所以什么也不会发生。</p>
<p>在你开始创建自己的 Touch Bar 和 Touch Bar Item 之前，你需要注意这些类都需要独一无二的 identifier（标识符），打开 <strong>TouchBarIdentifiers.swift</strong>，你将能看到两个扩展定义了一些标识符：<code>NSTouchBarCustomizationIdentifier</code> 和 <code>NSTouchBarItemIdentifier</code>。</p>
<p>前往 <strong>ViewController.swift</strong>，并把这些带码添加到文件最后 <code>// MARK: - TouchBar Delegate</code> 注释的后方：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@available</span>(<span class="type">OSX</span> <span class="number">10.12</span>.<span class="number">1</span>, *)</span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">ViewController</span>: <span class="title">NSTouchBarDelegate</span> </span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">makeTouchBar</span><span class="params">()</span></span> -&gt; <span class="type">NSTouchBar?</span> &#123;</span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line">    <span class="keyword">let</span> touchBar = <span class="type">NSTouchBar</span>()</span><br><span class="line">    touchBar.delegate = <span class="keyword">self</span></span><br><span class="line">    <span class="comment">// 2</span></span><br><span class="line">    touchBar.customizationIdentifier = .travelBar</span><br><span class="line">    <span class="comment">// 3</span></span><br><span class="line">    touchBar.defaultItemIdentifiers = [.infoLabelItem]</span><br><span class="line">    <span class="comment">// 4</span></span><br><span class="line">    touchBar.customizationAllowedItemIdentifiers = [.infoLabelItem]</span><br><span class="line">    <span class="keyword">return</span> touchBar</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在此处，通过重写 <code>makeTouchBar()</code> 方法，你给你的 View 或 Window 创建了一个 Touch Bar，在这个方法中：</p>
<ol>
<li>创建一个新的 <code>TouchBar</code> 并设置它的 delegate；</li>
<li>设置 customizationIdentifier（自定义标识符），每个 <code>TouchBar</code> 和 <code>TouchBarItem</code> 都需要一个独一无二的标识符；</li>
<li>设置 Touch Bar 的默认 item 标识符，这将会告诉 Touch Bar 它将会容纳哪些 item；</li>
<li>这一步是允许用户可以自定义的 item。作为参考，你可以打开 Finder，点击菜单栏上的 <strong>显示</strong> → <strong>自定 Multi-Touch Bar</strong>看看自定义 Touch Bar 是什么效果。</li>
</ol>
<p>接下来，我们还需要设置 <code>.infoLabelItem</code> 是什么样子的，在同一个 extension 中添加：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">touchBar</span><span class="params">(<span class="number">_</span> touchBar: NSTouchBar, makeItemForIdentifier identifier: NSTouchBarItemIdentifier)</span></span> -&gt; <span class="type">NSTouchBarItem?</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> identifier &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">NSTouchBarItemIdentifier</span>.infoLabelItem:</span><br><span class="line">      <span class="keyword">let</span> customViewItem = <span class="type">NSCustomTouchBarItem</span>(identifier: identifier)</span><br><span class="line">      customViewItem.view = <span class="type">NSTextField</span>(labelWithString: <span class="string">"\u&#123;1F30E&#125; \u&#123;1F4D3&#125;"</span>)</span><br><span class="line">      <span class="keyword">return</span> customViewItem</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过实现<code>touchBar(_:makeItemForIdentifier:)</code> 方法，你可以自定义你的 Touch Bar Item，在段代码里，你创建了一个 <code>NSCustomTouchBarItem</code>，并把它的 <code>view</code> 设置为了 <code>NSTextField</code>。</p>
<p>编译并运行你的 app，你可以看到 Touch Bar 多了一个 item。 </p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-96245a90a25d22dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>耶✌️！通过一番努力你得到了……两个 emoji…好吧，现在我们来添加一些别的控件。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-88d35baba7596185.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h1 id="Text-Field-和-Scrubber"><a href="#Text-Field-和-Scrubber" class="headerlink" title="Text Field 和 Scrubber"></a>Text Field 和 Scrubber</h1><p>在 <code>makeTouchBar()</code> 里，把 <code>touchBar.defaultItemIdentifiers = [.infoLabelItem]</code> 修改为：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touchBar.defaultItemIdentifiers = [.infoLabelItem, .flexibleSpace, .ratingLabel, .ratingScrubber]</span><br></pre></td></tr></table></figure>
<p>这些代码会让 Touch Bar 显示三个 item：一个 label、一个 scrubber 以及一个 <code>.flexibleSpace</code>。这是一个动态的间距，它可以把各种 item 按组进行整洁的分类。此外你还可以使用 <code>.fixedSpaceSmall</code> 和 <code>.fixedSpaceLarge</code> 这两个固定间距。</p>
<p>和之前的那个 label 一样，你也需要自定义这些 item，把这些 <code>cases</code> 添加到 <code>touchBar(_:makeItemForIdentifier:)</code> 里的 <code>switch</code>：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="type">NSTouchBarItemIdentifier</span>.ratingLabel:</span><br><span class="line">  <span class="comment">// 1</span></span><br><span class="line">  <span class="keyword">let</span> customViewItem = <span class="type">NSCustomTouchBarItem</span>(identifier: identifier)</span><br><span class="line">  customViewItem.view = <span class="type">NSTextField</span>(labelWithString: <span class="string">"Rating"</span>)</span><br><span class="line">  <span class="keyword">return</span> customViewItem</span><br><span class="line"><span class="keyword">case</span> <span class="type">NSTouchBarItemIdentifier</span>.ratingScrubber:</span><br><span class="line">  <span class="comment">// 2</span></span><br><span class="line">  <span class="keyword">let</span> scrubberItem = <span class="type">NSCustomTouchBarItem</span>(identifier: identifier)   </span><br><span class="line">  <span class="keyword">let</span> scrubber = <span class="type">NSScrubber</span>()</span><br><span class="line">  scrubber.scrubberLayout = <span class="type">NSScrubberFlowLayout</span>()</span><br><span class="line">  scrubber.register(<span class="type">NSScrubberTextItemView</span>.<span class="keyword">self</span>, forItemIdentifier: <span class="string">"RatingScrubberItemIdentifier"</span>)</span><br><span class="line">  scrubber.mode = .fixed</span><br><span class="line">  scrubber.selectionBackgroundStyle = .roundedBackground</span><br><span class="line">  scrubber.delegate = <span class="keyword">self</span></span><br><span class="line">  scrubber.dataSource = <span class="keyword">self</span></span><br><span class="line">  scrubberItem.view = scrubber</span><br><span class="line">  scrubber.bind(<span class="string">"selectedIndex"</span>, to: <span class="keyword">self</span>, withKeyPath: #keyPath(rating), options: <span class="literal">nil</span>)    </span><br><span class="line">  <span class="keyword">return</span> scrubberItem</span><br></pre></td></tr></table></figure>
<p>一步一步来看：</p>
<ol>
<li>为「评分」新建了一个新的 label item；</li>
<li>然后创建一个新的 item 用来展示 <code>NSScrubber</code>。这是一个 Touch Bar 特有的控件，它允许你在若干个项目中进行选择。Scrubber 需要一个代理来处理事件，你需要做的是设置一个 <code>delegate</code>（初始项目的源代码已经在 <strong>ViewController</strong> 里实现过这个协议了）。</li>
</ol>
<p>编译并运行你的 app，你将会看到 Touch Bar 里多出了两个新的 item，当你点击某个 scrubber 里的项目后，在 app 的主窗口里能看到数值的调整。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-de1447818a28d7be.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h1 id="Segmented-Control"><a href="#Segmented-Control" class="headerlink" title="Segmented Control"></a>Segmented Control</h1><p>接下来，我们来添加一个 Segmented Control。这个控件没有使用 Delegate 模式，因此这刚好可以让你体验一下怎么设置 Touch Bar 里的 <strong>Target-Action（目标动作）</strong>。回到 <code>makeTouchBar()</code> 中，把这三个 item 添加到 <code>defaultItemIdentifiers</code> 里：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touchBar.defaultItemIdentifiers = [.infoLabelItem, .flexibleSpace, .ratingLabel, .ratingScrubber, .flexibleSpace, .visitedLabelItem, .visitedItem, .visitSegmentedItem]</span><br></pre></td></tr></table></figure>
<p>以及把最后的三个 <code>case</code> 添加到 <code>touchBar(_:makeItemForIdentifier:)</code> 中：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="type">NSTouchBarItemIdentifier</span>.visitedLabelItem:</span><br><span class="line">  <span class="comment">// 1</span></span><br><span class="line">  <span class="keyword">let</span> customViewItem = <span class="type">NSCustomTouchBarItem</span>(identifier: identifier)</span><br><span class="line">  customViewItem.view = <span class="type">NSTextField</span>(labelWithString: <span class="string">"Times Visited"</span>)</span><br><span class="line">  <span class="keyword">return</span> customViewItem</span><br><span class="line"><span class="keyword">case</span> <span class="type">NSTouchBarItemIdentifier</span>.visitedItem:</span><br><span class="line">  <span class="comment">// 2</span></span><br><span class="line">  <span class="keyword">let</span> customViewItem = <span class="type">NSCustomTouchBarItem</span>(identifier: identifier)</span><br><span class="line">  customViewItem.view = <span class="type">NSTextField</span>(labelWithString: <span class="string">"--"</span>)</span><br><span class="line">  customViewItem.view.bind(<span class="string">"value"</span>, to: <span class="keyword">self</span>, withKeyPath: #keyPath(visited), options: <span class="literal">nil</span>)</span><br><span class="line">  <span class="keyword">return</span> customViewItem</span><br><span class="line"><span class="keyword">case</span> <span class="type">NSTouchBarItemIdentifier</span>.visitSegmentedItem:</span><br><span class="line">  <span class="comment">// 3</span></span><br><span class="line">  <span class="keyword">let</span> customActionItem = <span class="type">NSCustomTouchBarItem</span>(identifier: identifier)</span><br><span class="line">  <span class="keyword">let</span> segmentedControl = <span class="type">NSSegmentedControl</span>(images: [<span class="type">NSImage</span>(named: <span class="type">NSImageNameRemoveTemplate</span>)!, <span class="type">NSImage</span>(named: <span class="type">NSImageNameAddTemplate</span>)!], trackingMode: .momentary, target: <span class="keyword">self</span>, action: #selector(changevisitedAmount(<span class="number">_</span>:)))</span><br><span class="line">  segmentedControl.setWidth(<span class="number">40</span>, forSegment: <span class="number">0</span>)</span><br><span class="line">  segmentedControl.setWidth(<span class="number">40</span>, forSegment: <span class="number">1</span>)</span><br><span class="line">  customActionItem.view = segmentedControl</span><br><span class="line">  <span class="keyword">return</span> customActionItem</span><br></pre></td></tr></table></figure>
<p>一步一步看：</p>
<ol>
<li>和之前一样，创建一个简单的 Label；</li>
<li>创建另一个 Label，但这一次使用 <strong>bind</strong> 来把 Label 要显示的文本绑定到一个属性上；</li>
<li>最后，创建一个 Segmented Control，并设置它的 action。你可以看到，为它设置一个 action 和其他常见控件是完全一样的。</li>
</ol>
<p>编译并运行，除了 Scrubber，你现在还可以和 Segmented Control 交互了。此外，在 Touch Bar 里修改一个数值，app 的主窗口中也会显示出来，反之亦然。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-a7c5438cf524b6a1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h1 id="彩色按钮"><a href="#彩色按钮" class="headerlink" title="彩色按钮"></a>彩色按钮</h1><p>能让用户使用 Touch Bar 来进行「保存」操作是一个不错的点子，因为这个按钮和别的按钮都不一样，我们可以把它设置成绿色的。你可以使用 <code>NSButton</code> 的 <code>bezelColor</code> 属性来给它设置一个特殊的颜色。</p>
<p>打开 <strong>TouchBarIdentifiers.swift</strong>，在 <code>NSTouchBarItemIdentifier</code> extension 里，添加这些代码：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">let</span> saveItem = <span class="type">NSTouchBarItemIdentifier</span>(<span class="string">"com.razeware.SaveItem"</span>)</span><br></pre></td></tr></table></figure>
<p>这将会从头开始创建一个标识符，以此允许你在 Touch Bar 里添加一个 item。</p>
<p>返回 <strong>ViewController.swift</strong>，添加一个新的 <code>.flexSpace</code> 和 <code>.saveItem</code>  到 Touch Bar 的 <code>defaultItemIdentifiers</code> 里：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touchBar.defaultItemIdentifiers = [.infoLabelItem, .flexibleSpace, .ratingLabel, .ratingScrubber, .flexibleSpace, .visitedLabelItem, .visitedItem, .visitSegmentedItem, .flexibleSpace, .saveItem]</span><br></pre></td></tr></table></figure>
<p>基本上完成了，最后一步是对按钮进行一些设置。在 <code>touchBar(_:makeItemForIdentifier:)</code> 中添加最后一个 <code>case</code>：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="type">NSTouchBarItemIdentifier</span>.saveItem:</span><br><span class="line">  <span class="keyword">let</span> saveItem = <span class="type">NSCustomTouchBarItem</span>(identifier: identifier)</span><br><span class="line">  <span class="keyword">let</span> button = <span class="type">NSButton</span>(title: <span class="string">"Save"</span>, target: <span class="keyword">self</span>, action: #selector(save(<span class="number">_</span>:)))</span><br><span class="line">  button.bezelColor = <span class="type">NSColor</span>(red:<span class="number">0.35</span>, green:<span class="number">0.61</span>, blue:<span class="number">0.35</span>, alpha:<span class="number">1.00</span>)</span><br><span class="line">  saveItem.view = button</span><br><span class="line">  <span class="keyword">return</span> saveItem</span><br></pre></td></tr></table></figure>
<p>通过 <code>bezelColor</code>，你已经把这个按钮成功地修改成了绿色。</p>
<p>编译并运行，你会看到 Touch Bar 上有了一个绿色的按钮，它和窗口中的 <strong>Save</strong> 按钮拥有一样的功能。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-c9f44cf8bb30f2df.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h1 id="现在该做些啥？"><a href="#现在该做些啥？" class="headerlink" title="现在该做些啥？"></a>现在该做些啥？</h1><p>你可以<a href="https://koenig-media.raywenderlich.com/uploads/2016/10/TouchBar-Final-3.zip" target="_blank" rel="noopener">点击这里</a>下载最终完成的项目。 </p>
<p>这些就是 Touch Bar 的基础了。显然，Apple 希望 Touch Bar 的开发过程越简单越好，因此你可以尽快把这些特性尽快地带给新 MacBook Pro 的用户。</p>
<p>在这个教程中，你学到了：</p>
<ol>
<li>如何设置你的 app，让它能显示 Touch Bar；</li>
<li>如何在 Touch Bar 里显示静止的 Label；</li>
<li>如何使用 binding（绑定）来添加一个动态的 Label；</li>
<li>如何在 Touch Bar 中添加控件，并处理它们的事件。</li>
</ol>
<p>请不要在此停下！<code>NSTouchBar</code> 和 <code>NSTouchBarItem</code> 中还有很多值得探索的特性。你可以试着在 Touch Bar 里添加一个 Popover，或者也可以试试在你的 app 里格式化一个文本，你还可以在试着去在 Interface Builder 里创建一个 Touch Bar。</p>
<p><a href="https://www.raywenderlich.com/147118/use-nstouchbar-macos" target="_blank" rel="noopener">How to Use NSTouchBar on macOS</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/blog/">首页</a></li>
         
          <li><a href="/blog/archives/">归档</a></li>
         
          <li><a href="https://sr2k.top">简历</a></li>
         
          <li><a href="http://github.com/SR2k">项目</a></li>
         
          <li><a href="/blog/tags/">标签</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Touch-Bar-是个啥？"><span class="toc-number">1.</span> <span class="toc-text">Touch Bar 是个啥？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#如何让你的-app-支持-Touch-Bar"><span class="toc-number">2.</span> <span class="toc-text">如何让你的 app 支持 Touch Bar</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#准备开始"><span class="toc-number">3.</span> <span class="toc-text">准备开始</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Text-Field-和-Scrubber"><span class="toc-number">4.</span> <span class="toc-text">Text Field 和 Scrubber</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Segmented-Control"><span class="toc-number">5.</span> <span class="toc-text">Segmented Control</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#彩色按钮"><span class="toc-number">6.</span> <span class="toc-text">彩色按钮</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#现在该做些啥？"><span class="toc-number">7.</span> <span class="toc-text">现在该做些啥？</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&text=【译】如何在 macOS 上使用 NSTouchBar"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&title=【译】如何在 macOS 上使用 NSTouchBar"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&is_video=false&description=【译】如何在 macOS 上使用 NSTouchBar"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=【译】如何在 macOS 上使用 NSTouchBar&body=Check out this article: https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&title=【译】如何在 macOS 上使用 NSTouchBar"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&title=【译】如何在 macOS 上使用 NSTouchBar"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&title=【译】如何在 macOS 上使用 NSTouchBar"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&title=【译】如何在 macOS 上使用 NSTouchBar"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://sr2k.top/blog/2017/10/10/译-如何在macOS上使用NSTouchBar/&name=【译】如何在 macOS 上使用 NSTouchBar&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 Siyuan Cao
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/blog/">首页</a></li>
         
          <li><a href="/blog/archives/">归档</a></li>
         
          <li><a href="https://sr2k.top">简历</a></li>
         
          <li><a href="http://github.com/SR2k">项目</a></li>
         
          <li><a href="/blog/tags/">标签</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/blog/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/blog/lib/jquery/jquery.min.js"></script>
<script src="/blog/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<!-- clipboard -->

  <script src="/blog/lib/clipboard/clipboard.min.js"></script>
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功!");
      e.clearSelection();
    })
  })
  </script>

<script src="/blog/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-90173601-3', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
