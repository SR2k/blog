<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="æœ¬æ–‡ç¿»è¯‘è‡ª raywenderlich.com çš„ Core Graphics on macOS Tutorialï¼Œå·²å’¨è¯¢å¯¹æ–¹ç½‘ç«™ï¼Œå¯è‡³å¤šç¿»è¯‘ 10 ç¯‡æ–‡ç« ã€‚å¸Œæœ›å„ä½æœ‰è‹±è¯­é˜…è¯»èƒ½åŠ›çš„è¯ï¼Œè¿˜æ˜¯å…ˆæ‰“èµç„¶åå»é˜…è¯»è‹±æ–‡åŸå§ï¼Œæ¯•ç«Ÿæ— è®ºæ˜¯ Xcodeï¼ŒæŠ‘æˆ–æ˜¯å®˜æ–¹çš„æ–‡æ¡£ï¼Œè¿˜æ˜¯å„ç§æœ€å‰æ²¿çš„èµ„è®¯éƒ½åªæœ‰è‹±æ–‡ç‰ˆæœ¬ã€‚ç»¼ä¸Šï¼Œæ­¤ç¿»è¯‘ç‰ˆæœ¬ä»…ä¾›å‚è€ƒï¼Œè°¢ç»è½¬è½½ã€‚ ä¹Ÿæ¬¢è¿ä½ ç‚¹å‡»æˆ‘çš„å¤´åƒæŸ¥çœ‹æˆ‘ç¿»è¯‘çš„å…¶ä»– macOS å¼€å‘æ•™ç¨‹ğŸ’‹">
<meta name="keywords" content="ç¿»è¯‘,Ray Wenderlich,macOS,Swift">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹">
<meta property="og:url" content="https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/index.html">
<meta property="og:site_name" content="SR2k">
<meta property="og:description" content="æœ¬æ–‡ç¿»è¯‘è‡ª raywenderlich.com çš„ Core Graphics on macOS Tutorialï¼Œå·²å’¨è¯¢å¯¹æ–¹ç½‘ç«™ï¼Œå¯è‡³å¤šç¿»è¯‘ 10 ç¯‡æ–‡ç« ã€‚å¸Œæœ›å„ä½æœ‰è‹±è¯­é˜…è¯»èƒ½åŠ›çš„è¯ï¼Œè¿˜æ˜¯å…ˆæ‰“èµç„¶åå»é˜…è¯»è‹±æ–‡åŸå§ï¼Œæ¯•ç«Ÿæ— è®ºæ˜¯ Xcodeï¼ŒæŠ‘æˆ–æ˜¯å®˜æ–¹çš„æ–‡æ¡£ï¼Œè¿˜æ˜¯å„ç§æœ€å‰æ²¿çš„èµ„è®¯éƒ½åªæœ‰è‹±æ–‡ç‰ˆæœ¬ã€‚ç»¼ä¸Šï¼Œæ­¤ç¿»è¯‘ç‰ˆæœ¬ä»…ä¾›å‚è€ƒï¼Œè°¢ç»è½¬è½½ã€‚ ä¹Ÿæ¬¢è¿ä½ ç‚¹å‡»æˆ‘çš„å¤´åƒæŸ¥çœ‹æˆ‘ç¿»è¯‘çš„å…¶ä»– macOS å¼€å‘æ•™ç¨‹ğŸ’‹">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-5204a02b7332fac7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-f0a35f95c87f254e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-6aed1359cd471275.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-8f84eb5ad169695c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-4fc358f76ed26670.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-3dd1e7d056a92c9e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-80fe225f08e1c3f4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-8316bd45e283b331.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-3a9a9a76b687046c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-e86ac3d6a8e288b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-466bd5ddecfe519d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-ea983d52c0f02849.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-077fb51fe0aae885.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-8be0aad94ef83a2e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-11f0c635e8e2e781.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-c03336233ad3ca43.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-0d2de8a91a09b0bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-b066eae14cf2949c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-81d4bc8182f1d863.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-a87e7ca09027a440.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-bfc8259a9457f83f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-a1d8f29e9ccf8ff1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-53339621371d124f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-bf60da1d58848b16.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-e246d4795e5dec1b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-bda1ff3ab8d8e064.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-5169614dde1ef08a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-27ddddbb77a21564.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5477931-2b67c2e23ffc4526.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2019-07-19T05:03:34.684Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹">
<meta name="twitter:description" content="æœ¬æ–‡ç¿»è¯‘è‡ª raywenderlich.com çš„ Core Graphics on macOS Tutorialï¼Œå·²å’¨è¯¢å¯¹æ–¹ç½‘ç«™ï¼Œå¯è‡³å¤šç¿»è¯‘ 10 ç¯‡æ–‡ç« ã€‚å¸Œæœ›å„ä½æœ‰è‹±è¯­é˜…è¯»èƒ½åŠ›çš„è¯ï¼Œè¿˜æ˜¯å…ˆæ‰“èµç„¶åå»é˜…è¯»è‹±æ–‡åŸå§ï¼Œæ¯•ç«Ÿæ— è®ºæ˜¯ Xcodeï¼ŒæŠ‘æˆ–æ˜¯å®˜æ–¹çš„æ–‡æ¡£ï¼Œè¿˜æ˜¯å„ç§æœ€å‰æ²¿çš„èµ„è®¯éƒ½åªæœ‰è‹±æ–‡ç‰ˆæœ¬ã€‚ç»¼ä¸Šï¼Œæ­¤ç¿»è¯‘ç‰ˆæœ¬ä»…ä¾›å‚è€ƒï¼Œè°¢ç»è½¬è½½ã€‚ ä¹Ÿæ¬¢è¿ä½ ç‚¹å‡»æˆ‘çš„å¤´åƒæŸ¥çœ‹æˆ‘ç¿»è¯‘çš„å…¶ä»– macOS å¼€å‘æ•™ç¨‹ğŸ’‹">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/5477931-5204a02b7332fac7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
    
    
        
          
              <link rel="shortcut icon" href="/blog/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/blog/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹</title>
    <!-- styles -->
    <link rel="stylesheet" href="/blog/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/blog/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/blog/">é¦–é¡µ</a></li>
         
          <li><a href="/blog/archives/">å½’æ¡£</a></li>
         
          <li><a href="https://sr2k.top">ç®€å†</a></li>
         
          <li><a href="http://github.com/SR2k">é¡¹ç›®</a></li>
         
          <li><a href="/blog/tags/">tags</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/blog/2017/10/10/è¯‘-å¦‚ä½•åœ¨macOSä¸Šä½¿ç”¨NSTouchBar/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/blog/2017/09/24/è¯‘-NSCollectionViewå…¥é—¨æ•™ç¨‹/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">ä¸Šä¸€ç¯‡</span>
      <span id="i-next" class="info" style="display:none;">ä¸‹ä¸€ç¯‡</span>
      <span id="i-top" class="info" style="display:none;">è¿”å›é¡¶éƒ¨</span>
      <span id="i-share" class="info" style="display:none;">åˆ†äº«æ–‡ç« </span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&text=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&title=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&is_video=false&description=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹&body=Check out this article: https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&title=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&title=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&title=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&title=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&name=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#å‡†å¤‡å¼€å§‹"><span class="toc-number">1.</span> <span class="toc-text">å‡†å¤‡å¼€å§‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰è§†å›¾"><span class="toc-number">2.</span> <span class="toc-text">åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰è§†å›¾</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#åˆ›å»º-NSView-çš„å­ç±»"><span class="toc-number">2.1.</span> <span class="toc-text">åˆ›å»º NSView çš„å­ç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é‡å†™-draw"><span class="toc-number">2.2.</span> <span class="toc-text">é‡å†™ draw(_:)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å®æ—¶æ¸²æŸ“é¢„è§ˆï¼š-IBDesignable-å’Œ-IBInspectable"><span class="toc-number">3.</span> <span class="toc-text">å®æ—¶æ¸²æŸ“é¢„è§ˆï¼š@IBDesignable å’Œ @IBInspectable</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Graphics-Contextï¼ˆå›¾å½¢ä¸Šä¸‹æ–‡ï¼‰"><span class="toc-number">4.</span> <span class="toc-text">Graphics Contextï¼ˆå›¾å½¢ä¸Šä¸‹æ–‡ï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ç»˜åˆ¶è·¯å¾„"><span class="toc-number">5.</span> <span class="toc-text">ç»˜åˆ¶è·¯å¾„</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸ºé¥¼å›¾â€¦ç»˜åˆ¶ä¸€ä¸ªè·¯å¾„"><span class="toc-number">5.1.</span> <span class="toc-text">ä¸ºé¥¼å›¾â€¦ç»˜åˆ¶ä¸€ä¸ªè·¯å¾„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è®¡ç®—ä½ç½®"><span class="toc-number">5.2.</span> <span class="toc-text">è®¡ç®—ä½ç½®</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å‰ªåˆ‡ä¸€éƒ¨åˆ†åŒºåŸŸï¼ˆä¹Ÿå°±æ˜¯è’™ç‰ˆï¼‰"><span class="toc-number">6.</span> <span class="toc-text">å‰ªåˆ‡ä¸€éƒ¨åˆ†åŒºåŸŸï¼ˆä¹Ÿå°±æ˜¯è’™ç‰ˆï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ç»˜åˆ¶æ–‡æœ¬"><span class="toc-number">6.1.</span> <span class="toc-text">ç»˜åˆ¶æ–‡æœ¬</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cocoa-Drawing"><span class="toc-number">7.</span> <span class="toc-text">Cocoa Drawing</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ç»˜åˆ¶æ¸å˜"><span class="toc-number">7.1.</span> <span class="toc-text">ç»˜åˆ¶æ¸å˜</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ç»ƒä¹ -æŒ‘æˆ˜ï¼šç»˜åˆ¶é¥¼å›¾çš„å›¾ä¾‹"><span class="toc-number">8.</span> <span class="toc-text">ç»ƒä¹ /æŒ‘æˆ˜ï¼šç»˜åˆ¶é¥¼å›¾çš„å›¾ä¾‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ç­”æ¡ˆï¼šç»˜åˆ¶å›¾ä¾‹"><span class="toc-number">9.</span> <span class="toc-text">ç­”æ¡ˆï¼šç»˜åˆ¶å›¾ä¾‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ¥ä¸‹æ¥è¯¥åšå•¥ï¼Ÿ"><span class="toc-number">10.</span> <span class="toc-text">æ¥ä¸‹æ¥è¯¥åšå•¥ï¼Ÿ</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">SR2k</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2017-09-25T09:54:11.000Z" itemprop="datePublished">2017-09-25</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/blog/tags/Ray-Wenderlich/">Ray Wenderlich</a>, <a class="tag-link" href="/blog/tags/Swift/">Swift</a>, <a class="tag-link" href="/blog/tags/macOS/">macOS</a>, <a class="tag-link" href="/blog/tags/ç¿»è¯‘/">ç¿»è¯‘</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <blockquote>
<p>æœ¬æ–‡ç¿»è¯‘è‡ª <a href="https://www.raywenderlich.com/" target="_blank" rel="noopener">raywenderlich.com</a> çš„ <a href="https://www.raywenderlich.com/128614/core-graphics-os-x-tutorial" target="_blank" rel="noopener">Core Graphics on macOS Tutorial</a>ï¼Œå·²å’¨è¯¢å¯¹æ–¹ç½‘ç«™ï¼Œå¯è‡³å¤šç¿»è¯‘ 10 ç¯‡æ–‡ç« ã€‚<br>å¸Œæœ›å„ä½æœ‰è‹±è¯­é˜…è¯»èƒ½åŠ›çš„è¯ï¼Œè¿˜æ˜¯<strong>å…ˆæ‰“èµ</strong>ç„¶åå»é˜…è¯»è‹±æ–‡åŸå§ï¼Œæ¯•ç«Ÿæ— è®ºæ˜¯ Xcodeï¼ŒæŠ‘æˆ–æ˜¯å®˜æ–¹çš„æ–‡æ¡£ï¼Œè¿˜æ˜¯å„ç§æœ€å‰æ²¿çš„èµ„è®¯éƒ½åªæœ‰è‹±æ–‡ç‰ˆæœ¬ã€‚<br>ç»¼ä¸Šï¼Œæ­¤ç¿»è¯‘ç‰ˆæœ¬ä»…ä¾›å‚è€ƒï¼Œ<strong>è°¢ç»è½¬è½½</strong>ã€‚</p>
<p>ä¹Ÿæ¬¢è¿ä½ ç‚¹å‡»æˆ‘çš„å¤´åƒæŸ¥çœ‹æˆ‘ç¿»è¯‘çš„å…¶ä»– macOS å¼€å‘æ•™ç¨‹ğŸ’‹</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-5204a02b7332fac7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<blockquote>
<p><strong>æ›´æ–°äº 2016-9-22ï¼š</strong>æ­¤æ•™ç¨‹å·²æ›´æ–°è‡³ Xcode 8 å’Œ Swift 3ã€‚</p>
</blockquote>
<p>ä½ è‚¯å®šè§è¿‡è®¸å¤šæ‹¥æœ‰æ¼‚äº®çš„ç•Œé¢å’Œåä¸½çš„è‡ªå®šä¹‰è§†å›¾çš„ appï¼Œå®ƒä»¬è‚¯å®šåœ¨ä½ çš„å¿ƒé‡Œç•™ä¸‹äº†æ·±åˆ»çš„å°è±¡ï¼Œå› ä¸ºå®ƒä»¬æ˜¯<strong>é‚£ï¼ä¹ˆï¼å¥½ï¼çœ‹ï¼</strong></p>
<p><strong>Core Graphics</strong> æ˜¯ Apple æä¾›çš„ 2D ç»˜å›¾å¼•æ“ï¼Œä¹Ÿå‡ ä¹æ˜¯ macOS å’Œ iOS æ‰€æœ‰æ¡†æ¶ä¸­æœ€é…·çš„äº†ã€‚å®ƒå¯ä»¥ç”¨æ¥ç»˜åˆ¶ä½ èƒ½æƒ³åˆ°çš„æ‰€æœ‰å›¾å½¢ï¼Œä»ç®€å•çš„å‡ ä½•å½¢çŠ¶åˆ°å¤æ‚çš„é˜´å½±å’Œæ¸å˜ç­‰è§†è§‰æ•ˆæœã€‚</p>
<p>åœ¨è¿™ä¸ª macOS Core Graphics æ•™ç¨‹ä¸­ï¼Œä½ å°†ä¼šåˆ›é€ ä¸€ä¸ªå«åš <strong>DiskInfo</strong> çš„è‡ªå®šä¹‰è§†å›¾ï¼Œå®ƒèƒ½ç”¨ä¸€å¼ é¥¼å›¾å’Œä¸€ä¸ªæ¡çŠ¶å›¾æ¥æ˜¾ç¤ºå‡ºä½  Mac ä¸Šçš„ç¡¬ç›˜å¯ç”¨ç©ºé—´ã€‚è¿™ä¸ªæ•™ç¨‹å°†ä¼šè®©ä½ æ‹¥æœ‰æŠŠå¹³æ·¡å•è°ƒçš„ UI å˜å¾—ç²¾å½©çº·å‘ˆçš„èƒ½åŠ›ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-f0a35f95c87f254e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>åœ¨è¿™ä¸ªæ•™ç¨‹ä¸­ä½ å°†å­¦ä¼šï¼š</p>
<ul>
<li>åˆ›å»ºå¹¶é…ç½®ä¸€ä¸ªè‡ªå®šä¹‰è§†å›¾ï¼Œè¿™æ˜¯ç»˜åˆ¶å›¾å½¢å…ƒç´ çš„å¿…è¦æ¡ä»¶ï¼›</li>
<li>å®ç°å®æ—¶æ¸²æŸ“é¢„è§ˆåŠŸèƒ½ï¼Œæœ‰äº†å®ƒä½ ä¸éœ€è¦ç¼–è¯‘å’Œè¿è¡Œï¼Œå°±èƒ½åœ¨ Interface Builder é‡Œçœ‹åˆ°ä½ å¯¹å›¾å½¢çš„å„ç§ä¿®æ”¹ï¼›</li>
<li>ç”¨ä»£ç ç»˜åˆ¶è·¯å¾„ã€å¡«å……å›¾å½¢ã€åˆ›å»ºå‰ªåˆ‡è’™ç‰ˆå‰ªè¾‘å’Œæ¸²æŸ“æ–‡æœ¬ï¼›</li>
<li>ä½¿ç”¨ <strong>AppKit</strong> é‡Œçš„ <strong>Cocoa Drawing</strong> å·¥å…·æä¾›çš„é«˜çº§ç±»å’Œæ–¹æ³•ã€‚</li>
</ul>
<p>åœ¨ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œä½ å°†ä¼šé€šè¿‡ Core Graphics æ¥å®ç°ç»˜åˆ¶ä¸€ä¸ªé¥¼å›¾ï¼Œç¨åä½ å°†ä¼šå­¦ä¹ å¦‚ä½•ç”¨ Cocoa Drawing å®ç°ç›¸åŒçš„æ•ˆæœã€‚</p>
<p>æ‰€ä»¥æ‹¿èµ·ä½ çš„å°ç”»åˆ·ï¼Œæˆ‘ä»¬è¦å¼€å§‹ä½œç”»å•¦ï½</p>
<h1 id="å‡†å¤‡å¼€å§‹"><a href="#å‡†å¤‡å¼€å§‹" class="headerlink" title="å‡†å¤‡å¼€å§‹"></a>å‡†å¤‡å¼€å§‹</h1><p><a href="https://koenig-media.raywenderlich.com/uploads/2016/06/DiskInfo-Starter.zip" target="_blank" rel="noopener">ç‚¹å‡»è¿™é‡Œ</a>ä¸‹è½½ DiskInfo çš„èµ·æ­¥å·¥ç¨‹ï¼Œç¼–è¯‘å¹¶è¿è¡Œå®ƒï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-6aed1359cd471275.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>è¿™ä¸ª app ä¼šç½—åˆ—å‡ºä½ çš„æ‰€æœ‰ç¡¬ç›˜ï¼Œç‚¹å‡»ä»»ä½•ä¸€ä¸ªå³å¯æŸ¥çœ‹ä»–çš„è¯¦ç»†ä¿¡æ¯ã€‚</p>
<p>åœ¨æ“ä½œä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç†Ÿæ‚‰ä¸€ä¸‹è¿™ä¸ªé¡¹ç›®çš„ç»“æ„ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-8f84eb5ad169695c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<ul>
<li><strong>ViewController.swift</strong>ï¼šapp çš„ä¸»è¦ View Controllerï¼›</li>
<li><strong>VolumeInfo.swift</strong>ï¼šå®ç°äº†ç”¨äºå¤„ç†ç¡¬ç›˜ä¿¡æ¯çš„ <code>VolumeInfo</code> ç±»ï¼Œä»¥åŠç”¨äºåˆ†æä¸åŒæ–‡ä»¶ç±»å‹æ‰€å ç©ºé—´çš„ <code>FilesDistribution</code> ç»“æ„ä½“ï¼›</li>
<li><strong>NSColor+DiskInfo.swift</strong> å’Œ <strong>NSFont+DiskInfo.swift</strong>ï¼šæ‰©å±•äº† NSColorï¼Œå®šä¹‰äº† app ä¸­ä¼šç”¨åˆ°çš„é¢œè‰²å’Œå­—ä½“ï¼›</li>
<li><strong>CGFloat+Radians.swift</strong>ï¼šæ‰©å±•äº† CGFloatï¼Œæä¾›äº†è½¬æ¢è§’åº¦å€¼å’Œå¼§åº¦åˆ¶çš„ helper æ–¹æ³•ï¼›</li>
<li><strong>MountedVolumesDataSource.swift</strong> å’Œ <strong>MountedVolumesDelegate.swift</strong>ï¼šå®ç°äº†æ˜¾ç¤ºç¡¬ç›˜ä¿¡æ¯æ‰€å¿…éœ€çš„å„ç±»æ–¹æ³•ã€‚</li>
</ul>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong>è¿™ä¸ª app å¯ä»¥æ˜¾ç¤ºä½ çœŸæ­£çš„ç¡¬ç›˜ç”¨é‡ä¿¡æ¯ï¼Œä½†åœ¨è¿™ä¸ªæ•™ç¨‹ä¸­ï¼Œå®ƒå°†ä¼šç”Ÿæˆéšæœºçš„æ•°æ®ã€‚<br>æ¯æ¬¡å¯åŠ¨ app æ—¶éƒ½è®¡ç®—ä¸€æ¬¡ç¡¬ç›˜ä¸Šæ‰€æœ‰æ–‡ä»¶çš„ç±»å‹ä¼šå¾ˆè€—æ—¶ï¼Œä¹Ÿä¼šæ¶ˆç£¨å®Œä½ æ‰€æœ‰çš„ä¹è¶£ï¼Œæ²¡äººæ„¿æ„åœ¨è¿™ä¸Šé¢æµªè´¹æ—¶é—´ï¼Œå¯¹å§ğŸ˜‰ï¼Ÿ</p>
</blockquote>
<h1 id="åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰è§†å›¾"><a href="#åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰è§†å›¾" class="headerlink" title="åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰è§†å›¾"></a>åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰è§†å›¾</h1><p>ä½ è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯åˆ›å»ºä¸€ä¸ªåå« <code>GraphView</code> çš„è‡ªå®šä¹‰è§†å›¾ã€‚è¿™å°†ä¼šæ˜¯ä½ ç»˜åˆ¶é¥¼çŠ¶å›¾å’Œæ¡å½¢å›¾çš„åœ°æ–¹ã€‚è¿™ä¸ªéƒ¨åˆ†ä¸­ä½ éœ€è¦åšä¸¤ä»¶äº‹ï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ª <code>NSView</code> çš„å­ç±»ï¼›</li>
<li>é‡å†™ <code>draw(_:)</code> æ–¹æ³•ï¼ŒåŠ å…¥ä¸€äº›ç”¨äºç»˜åˆ¶çš„ä»£ç ã€‚</li>
</ol>
<h2 id="åˆ›å»º-NSView-çš„å­ç±»"><a href="#åˆ›å»º-NSView-çš„å­ç±»" class="headerlink" title="åˆ›å»º NSView çš„å­ç±»"></a>åˆ›å»º NSView çš„å­ç±»</h2><p>é€‰ä¸­é¡¹ç›®å¯¼èˆªå™¨çš„ <strong>Views</strong> åˆ†ç»„ï¼Œç‚¹å‡»å» Xcode èœå•ä¸Šçš„ <strong>File</strong> â†’ <strong>New</strong> â†’ <strong>Fileâ€¦</strong>ï¼Œç„¶åç‚¹å‡» <strong>macOS</strong> â†’ <strong>Source</strong> â†’ <strong>Cocoa Class</strong> æ¨¡ç‰ˆã€‚</p>
<p>ç‚¹å‡» <strong>Next</strong>ï¼ŒæŠŠæ–°çš„ç±»å‘½åä¸º <code>GraphView</code>ï¼Œå¹¶è®©å®ƒç»§æ‰¿è‡ª <code>NSView</code>ï¼ŒæŠŠè¯­è¨€é€‰æ‹©ä¸º <strong>Swift</strong>ã€‚</p>
<p>ç‚¹å‡» <strong>Next</strong> å’Œ <strong>Create</strong> æ¥ä¿å­˜ä½ çš„æ–‡ä»¶ã€‚</p>
<p>æ‰“å¼€ <strong>Main.storyboard</strong>ï¼Œåœ¨ <strong>View Controller Scene</strong> ä¸­ï¼Œä»<strong>æ§ä»¶åº“</strong>é‡Œæ‹–å…¥ä¸€ä¸ª <strong>Custom View</strong>ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-4fc358f76ed26670.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>é€‰ä¸­è¿™ä¸ª Custom Viewï¼Œåœ¨<strong>èº«ä»½æ£€æŸ¥å™¨</strong>é‡Œï¼ŒæŠŠå®ƒçš„ç±»åè®¾ç½®ä¸º <code>GraphView</code>ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-3dd1e7d056a92c9e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>ä½ éœ€è¦ä¸€äº›çº¦æŸï¼Œæ‰€ä»¥ä¿æŒ Graph View çš„é€‰ä¸­çŠ¶æ€ï¼Œç‚¹å‡» Auto Layout å·¥å…·æ ä¸Šçš„ <strong>Pin</strong> æŒ‰é’®ï¼ŒæŠŠå®ƒçš„ <strong>Top</strong>ã€<strong>Bottom</strong>ã€<strong>Leading</strong> å’Œ <strong>Trailing</strong> çº¦æŸè®¾ç½®ä¸º 0ï¼Œç„¶åç‚¹å‡» <strong>Add 4 Constrains</strong> æŒ‰é’®ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-80fe225f08e1c3f4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>ç‚¹å‡» Auto Layout å·¥å…·æ ä¸Šçš„ä¸‰è§’å½¢çš„ <strong>Resolve Auto Layout Issues</strong> æŒ‰é’®ï¼Œç„¶ååœ¨ <strong>Selected Views</strong> éƒ¨åˆ†ä¸­ç‚¹å‡» <strong>Update Frames</strong>ã€‚å¦‚æœè¿™ä¸ªé€‰é¡¹ä¸å¯ç”¨ï¼Œä½ å¯èƒ½éœ€è¦å…ˆç‚¹å‡»ç©ºç™½å¤„å–æ¶ˆé€‰ä¸­ Graph Viewï¼Œç„¶åå†æ¬¡é€‰ä¸­å®ƒã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-8316bd45e283b331.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="é‡å†™-draw"><a href="#é‡å†™-draw" class="headerlink" title="é‡å†™ draw(_:)"></a>é‡å†™ <code>draw(_:)</code></h2><p>æ‰“å¼€ <strong>GraphView.swift</strong>ï¼Œä½ èƒ½çœ‹åˆ° Xcode è‡ªåŠ¨ä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª <code>draw(_:)</code> çš„å®ç°ã€‚æŠŠé‚£è¡Œæ³¨é‡Šæ›¿æ¢æˆä»¥ä¸‹ä»£ç ï¼Œå¹¶ç¡®ä¿ä½ åˆ«ä¸å°å¿ƒåˆ æ‰äº†å®ƒè°ƒç”¨çˆ¶ç±»æ­¤æ–¹æ³•çš„é‚£ä¸€è¡Œå“¦ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NSColor</span>.white.setFill() </span><br><span class="line"><span class="type">NSRectFill</span>(bounds)</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€è¡Œä»£ç æŠŠå¡«å……é¢œè‰²è®¾ç½®ä¸ºäº†ç™½è‰²ï¼Œç„¶åé€šè¿‡è°ƒç”¨ <code>NSRectFill</code> æ–¹æ³•ï¼Œä½ æŠŠæ•´ä¸ªè§†å›¾çš„èƒŒæ™¯è®¾æˆäº†ç™½è‰²ã€‚</p>
<p>ç¼–è¯‘å¹¶è¿è¡Œï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-3a9a9a76b687046c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>ä½ å·²ç»æŠŠè‡ªå®šä¹‰è§†å›¾çš„èƒŒæ™¯ä»é»˜è®¤çš„ç°è‰²æ”¹æˆäº†ç™½è‰²ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-e86ac3d6a8e288b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>å“ˆå“ˆï¼Œæˆ‘ä»¬çš„ç”»å¸ƒå·²ç»å°±ç»ªï¼å°±æ˜¯è¿™ä¹ˆç®€å•ï½</p>
<h1 id="å®æ—¶æ¸²æŸ“é¢„è§ˆï¼š-IBDesignable-å’Œ-IBInspectable"><a href="#å®æ—¶æ¸²æŸ“é¢„è§ˆï¼š-IBDesignable-å’Œ-IBInspectable" class="headerlink" title="å®æ—¶æ¸²æŸ“é¢„è§ˆï¼š@IBDesignable å’Œ @IBInspectable"></a>å®æ—¶æ¸²æŸ“é¢„è§ˆï¼š<code>@IBDesignable</code> å’Œ <code>@IBInspectable</code></h1><p>Xcode 6 ä¸ºæˆ‘ä»¬å¸¦æ¥äº†ä¸€ä¸ªç‰›Ã—çš„åŠŸèƒ½ï¼šå®æ—¶æ¸²æŸ“é¢„è§ˆã€‚å®ƒå…è®¸ä½ åœ¨ Interface Builder é‡ŒæŸ¥çœ‹ä½ è‡ªå®šä¹‰çš„è§†å›¾çš„æ ·å­ï¼Œè€Œä¸ç”¨æ¯æ¬¡éƒ½ç¼–è¯‘å’Œè¿è¡Œã€‚</p>
<p>è¦å¯ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œä½ éœ€è¦ç”¨ <code>@IBDesignable</code> æ¥ä¿®é¥°ä½ çš„ç±»ï¼›å¹¶å®ç° <code>prepareForInterfaceBuilder()</code> æ–¹æ³•æ¥æä¾›ä¸€äº›ç¤ºä¾‹æ•°æ®ï¼ˆå®ç°è¿™ä¸ªæ–¹æ³•ä¸æ˜¯å¿…é¡»çš„ï¼‰ã€‚</p>
<p>æ‰“å¼€ <strong>GraphView.swift</strong>ï¼Œåœ¨ç±»çš„å®šä¹‰ä¹‹å‰åŠ å…¥ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@IBDesignable</span></span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ä½ éœ€è¦æä¾›ä¸€äº›ç¤ºä¾‹æ•°æ®ï¼ŒæŠŠè¿™äº›ä»£ç æ·»åŠ åˆ° <code>GraphView</code> ç±»ä¸­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fileDistribution: <span class="type">FilesDistribution?</span> &#123;</span><br><span class="line">  <span class="keyword">didSet</span> &#123;</span><br><span class="line">    needsDisplay = <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">prepareForInterfaceBuilder</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">let</span> used = <span class="type">Int64</span>(<span class="number">100000000000</span>)</span><br><span class="line">  <span class="keyword">let</span> available = used / <span class="number">3</span></span><br><span class="line">  <span class="keyword">let</span> filesBytes = used / <span class="number">5</span></span><br><span class="line">  <span class="keyword">let</span> distribution: [<span class="type">FileType</span>] = [</span><br><span class="line">    .apps(bytes: filesBytes / <span class="number">2</span>, percent: <span class="number">0.1</span>),</span><br><span class="line">    .photos(bytes: filesBytes, percent: <span class="number">0.2</span>),</span><br><span class="line">    .movies(bytes: filesBytes * <span class="number">2</span>, percent: <span class="number">0.15</span>),</span><br><span class="line">    .audio(bytes: filesBytes, percent: <span class="number">0.18</span>),</span><br><span class="line">    .other(bytes: filesBytes, percent: <span class="number">0.2</span>)</span><br><span class="line">  ]</span><br><span class="line">  fileDistribution = <span class="type">FilesDistribution</span>(capacity: used + available,</span><br><span class="line">                                       available: available,</span><br><span class="line">                                       distribution: distribution)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™å°†ä¼šå®šä¹‰ä¸€ä¸ª <code>fileDistribution</code> å±æ€§ç”¨äºå­˜å‚¨ç¡¬ç›˜çš„ä¿¡æ¯ã€‚å½“è¿™ä¸ªå±æ€§å‘ç”Ÿæ”¹å˜ï¼Œå®ƒä¼šè®¾ç½®è¿™ä¸ªè§†å›¾çš„ <code>needsDisplay</code> å±æ€§ä¸º <code>true</code>ï¼Œä»è€Œè®©è§†å›¾é‡ç»˜è‡ªå·±çš„å†…å®¹ã€‚</p>
<p>ç„¶åï¼Œå®ƒå®ç°äº†  <code>prepareForInterfaceBuilder()</code> æ–¹æ³•ï¼Œä»¥æ­¤åˆ›å»ºäº†ä¸€ä¸ªå„ç§æ–‡ä»¶ç±»å‹çš„ä¾‹å­ï¼Œç”¨äºç»™ Xcode é¢„è§ˆè¿™ä¸ªè§†å›¾ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong>ä½ ç”šè‡³å¯ä»¥åœ¨ Interface Builder é‡Œå®æ—¶ä¿®æ”¹è§†è§‰å±æ€§ã€‚è¿™è¦æ±‚ä½ ç”¨ <code>@IBInspectable</code> æ¥ä¿®é¥°è¿™ä¸ªå±æ€§ã€‚</p>
</blockquote>
<p>ä¸‹ä¸€æ­¥ï¼šç”¨ <code>@IBInspectable</code> ä¿®é¥°æ‰€æœ‰çš„è§†è§‰å±æ€§ï¼ŒæŠŠè¿™äº›ä»£ç æ·»åŠ åˆ° <code>GraphView</code> çš„å£°æ˜ä¸­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="keyword">fileprivate</span> <span class="class"><span class="keyword">struct</span> <span class="title">Constants</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">let</span> barHeight: <span class="type">CGFloat</span> = <span class="number">30.0</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">let</span> barMinHeight: <span class="type">CGFloat</span> = <span class="number">20.0</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">let</span> barMaxHeight: <span class="type">CGFloat</span> = <span class="number">40.0</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">let</span> marginSize: <span class="type">CGFloat</span> = <span class="number">20.0</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">let</span> pieChartWidthPercentage: <span class="type">CGFloat</span> = <span class="number">1.0</span> / <span class="number">3.0</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">let</span> pieChartBorderWidth: <span class="type">CGFloat</span> = <span class="number">1.0</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">let</span> pieChartMinRadius: <span class="type">CGFloat</span> = <span class="number">30.0</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">let</span> pieChartGradientAngle: <span class="type">CGFloat</span> = <span class="number">90.0</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">let</span> barChartCornerRadius: <span class="type">CGFloat</span> = <span class="number">4.0</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">let</span> barChartLegendSquareSize: <span class="type">CGFloat</span> = <span class="number">8.0</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">let</span> legendTextMargin: <span class="type">CGFloat</span> = <span class="number">5.0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> barHeight: <span class="type">CGFloat</span> = <span class="type">Constants</span>.barHeight &#123;</span><br><span class="line">  <span class="keyword">didSet</span> &#123;</span><br><span class="line">    barHeight = <span class="built_in">max</span>(<span class="built_in">min</span>(barHeight, <span class="type">Constants</span>.barMaxHeight), <span class="type">Constants</span>.barMinHeight)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> pieChartUsedLineColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.pieChartUsedStrokeColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> pieChartAvailableLineColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.pieChartAvailableStrokeColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> pieChartAvailableFillColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.pieChartAvailableFillColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> pieChartGradientStartColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.pieChartGradientStartColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> pieChartGradientEndColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.pieChartGradientEndColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> barChartAvailableLineColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.availableStrokeColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> barChartAvailableFillColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.availableFillColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> barChartAppsLineColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.appsStrokeColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> barChartAppsFillColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.appsFillColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> barChartMoviesLineColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.moviesStrokeColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> barChartMoviesFillColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.moviesFillColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> barChartPhotosLineColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.photosStrokeColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> barChartPhotosFillColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.photosFillColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> barChartAudioLineColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.audioStrokeColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> barChartAudioFillColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.audioFillColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> barChartOthersLineColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.othersStrokeColor</span><br><span class="line"><span class="meta">@IBInspectable</span> <span class="keyword">var</span> barChartOthersFillColor: <span class="type">NSColor</span> = <span class="type">NSColor</span>.othersFillColor</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">colorsForFileType</span><span class="params">(fileType: FileType)</span></span> -&gt; (strokeColor: <span class="type">NSColor</span>, fillColor: <span class="type">NSColor</span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> fileType &#123;</span><br><span class="line">  <span class="keyword">case</span> .audio(<span class="number">_</span>, <span class="number">_</span>):</span><br><span class="line">    <span class="keyword">return</span> (strokeColor: barChartAudioLineColor, fillColor: barChartAudioFillColor)</span><br><span class="line">  <span class="keyword">case</span> .movies(<span class="number">_</span>, <span class="number">_</span>):</span><br><span class="line">    <span class="keyword">return</span> (strokeColor: barChartMoviesLineColor, fillColor: barChartMoviesFillColor)</span><br><span class="line">  <span class="keyword">case</span> .photos(<span class="number">_</span>, <span class="number">_</span>):</span><br><span class="line">    <span class="keyword">return</span> (strokeColor: barChartPhotosLineColor, fillColor: barChartPhotosFillColor)</span><br><span class="line">  <span class="keyword">case</span> .apps(<span class="number">_</span>, <span class="number">_</span>):</span><br><span class="line">    <span class="keyword">return</span> (strokeColor: barChartAppsLineColor, fillColor: barChartAppsFillColor)</span><br><span class="line">  <span class="keyword">case</span> .other(<span class="number">_</span>, <span class="number">_</span>):</span><br><span class="line">    <span class="keyword">return</span> (strokeColor: barChartOthersLineColor, fillColor: barChartOthersFillColor)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸€å¤§å¨ä»£ç çš„ä½œç”¨æ˜¯ï¼š</p>
<ol>
<li>å£°æ˜äº†å¸¦æœ‰è®¸å¤šå¸¸é‡çš„ç»“æ„ä½“ â€”â€” ä½ å¾—åœ¨è¿™ä¸ª app çš„å„ä¸ªåœ°æ–¹ç”¨åˆ°å®ƒä»¬ï¼›</li>
<li>ç”¨ <code>@IBInspectable</code> ä¿®é¥°æ‰€æœ‰å¯é…ç½®çš„å±æ€§ã€‚å¹¶ä½¿ç”¨ <strong>NSColor+DiskInfo.swift</strong> ä¸­çš„å€¼ä¸ºå®ƒä»¬èµ‹å€¼ã€‚æ³¨æ„ï¼šè¦ä½¿ä¸€ä¸ªå±æ€§ã€Œinspectableã€ï¼ˆå¯ä»¥åœ¨ Interface Builder é‡Œç›´æ¥ç¼–è¾‘ï¼‰ï¼Œä½ å¿…é¡»å£°æ˜å®ƒçš„ç±»å‹ï¼Œå³ä½¿å¤§å¤šæ•°æƒ…å†µä¸‹ Swift ä¼šå¸®ä½ åšè¿™ä»¶äº‹å„¿ï¼›</li>
<li>å®šä¹‰ä¸€ä¸ª Helper æ–¹æ³•ï¼Œä¸ºä¸åŒçš„æ–‡ä»¶ç±»å‹è¿”å›å®ƒçš„ç¬”è§¦é¢œè‰²å’Œå¡«å……é¢œè‰²ã€‚ä½ åœ¨ç»˜åˆ¶ã€Œä»€ä¹ˆæ–‡ä»¶å äº†å¤šå¤§åœ°å„¿ã€çš„å›¾è¡¨çš„æ—¶å€™ä¼šç”¨åˆ°å®ƒã€‚</li>
</ol>
<p>æ‰“å¼€ <strong>Main.stroyboard</strong>ï¼Œä½ åº”è¯¥èƒ½æ³¨æ„åˆ° Graph View å·²ç»ä»é»˜è®¤çš„ç°è‰²å˜æˆäº†ç™½è‰²ï¼Œè¿™æ„å‘³ç€å®æ—¶æ¸²æŸ“é¢„è§ˆå·²ç»èµ·ä½œç”¨äº†ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-466bd5ddecfe519d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>é€‰ä¸­ Graph Viewï¼Œæ‰“å¼€<strong>å±æ€§æ£€æŸ¥å™¨</strong>ï¼Œä½ ä¼šå‘ç°æ‰€æœ‰çš„ã€Œinspectableã€å±æ€§å·²ç»å‡ºç°åœ¨è¿™é‡Œäº†ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-ea983d52c0f02849.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>ç°åœ¨å¼€å§‹ï¼Œè¦æŸ¥çœ‹è°ƒæ•´å¥½çš„æ•ˆæœï¼Œä½ å¯ä»¥ç›´æ¥ç¼–è¯‘å’Œè¿è¡Œï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨ Interface Builder é‡ŒæŸ¥çœ‹ã€‚</p>
<p>ä¸‡äº‹ä¿±å¤‡ï¼Œæ˜¯æ—¶å€™å¼€å§‹çœŸæ­£çš„ç»˜åˆ¶å•¦ï¼</p>
<h1 id="Graphics-Contextï¼ˆå›¾å½¢ä¸Šä¸‹æ–‡ï¼‰"><a href="#Graphics-Contextï¼ˆå›¾å½¢ä¸Šä¸‹æ–‡ï¼‰" class="headerlink" title="Graphics Contextï¼ˆå›¾å½¢ä¸Šä¸‹æ–‡ï¼‰"></a>Graphics Contextï¼ˆå›¾å½¢ä¸Šä¸‹æ–‡ï¼‰</h1><p>åœ¨ä½¿ç”¨ Core Graphics çš„æ—¶å€™ï¼Œä½ å¹¶ä¸æ˜¯ç›´æ¥åœ¨è§†å›¾ä¸­ç»˜ç”»ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªå« <strong>Graphics Contextï¼ˆå›¾å½¢ä¸Šä¸‹æ–‡ï¼‰</strong>çš„ä¸œè¥¿ï¼Œå®ƒæ˜¯ç³»ç»Ÿæ¸²æŸ“å›¾å½¢ä¸æŠŠå›¾å½¢æ˜¾ç¤ºåœ¨è§†å›¾ä¸­çš„ä¸­é—´å±‚ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-077fb51fe0aae885.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>Core Graphics ä½¿ç”¨ä¸€ä¸ªå«ã€ŒPainterâ€™s Modelï¼ˆç”»å®¶æ¨¡å¼ï¼‰ã€çš„æ¨¡å¼ï¼Œä½ å¯ä»¥æƒ³åƒæˆè‡ªå·±æ‹¿ç€ç¬”ï¼Œå”°å”°åœ°åœ¨ç”»å¸ƒä¸Šç»˜å›¾æ ·å­ã€‚ä½ éœ€è¦æ”¾ç½®ä¸€ä¸ªè·¯å¾„ï¼Œç„¶åå»å¡«å……å®ƒï¼Œä½ æ²¡åŠæ³•å»æ”¹å˜å·²ç»å¸ƒç½®å¥½çš„åƒç´ ä»¬ï¼Œä½†ä½ å¯ä»¥åœ¨å®ƒä»¬ä¹‹ä¸Šç»§ç»­ç”»å›¾ã€‚</p>
<p>è¿™ä¸ªã€Œä¸Šä¸‹æ–‡ã€éå¸¸é‡è¦ï¼Œå› ä¸ºä»–å†³å®šäº†ä½ æœ€ç»ˆå¾—åˆ°çš„æ•ˆæœã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-8be0aad94ef83a2e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h1 id="ç»˜åˆ¶è·¯å¾„"><a href="#ç»˜åˆ¶è·¯å¾„" class="headerlink" title="ç»˜åˆ¶è·¯å¾„"></a>ç»˜åˆ¶è·¯å¾„</h1><p>è¦ä½¿ç”¨ Core Graphics ç»˜åˆ¶ä¸€ä¸ªè·¯å¾„ï¼Œä½ éœ€è¦å®šä¹‰ä¸€ä¸ª <strong>Pathï¼ˆè·¯å¾„ï¼‰</strong>ï¼Œä¹Ÿå°±æ˜¯ <code>CGPathRef</code> å’Œå¯å˜çš„ <code>CGMutablePathRef</code>ã€‚</p>
<p>è·¯å¾„å‡†å¤‡å¥½ä»¥åï¼ŒæŠŠå®ƒæ·»åŠ åˆ°å›¾å½¢ä¸Šä¸‹æ–‡é‡Œï¼Œå°±å¯ä»¥æ ¹æ®è·¯å¾„å’Œç»˜åˆ¶å±æ€§æ¸²æŸ“å‡ºä½ è¦çš„å›¾å½¢äº†ã€‚</p>
<h2 id="ä¸ºé¥¼å›¾â€¦ç»˜åˆ¶ä¸€ä¸ªè·¯å¾„"><a href="#ä¸ºé¥¼å›¾â€¦ç»˜åˆ¶ä¸€ä¸ªè·¯å¾„" class="headerlink" title="ä¸ºé¥¼å›¾â€¦ç»˜åˆ¶ä¸€ä¸ªè·¯å¾„"></a>ä¸ºé¥¼å›¾â€¦ç»˜åˆ¶ä¸€ä¸ªè·¯å¾„</h2><p>æ¡å½¢å›¾çš„åŸºæœ¬å…ƒç´ æ˜¯åœ†è§’çŸ©å½¢ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»è¿™é‡Œå¼€å§‹å…¥æ‰‹ã€‚</p>
<p>æ‰“å¼€ <strong>GraphView.swift</strong>ï¼ŒæŠŠè¿™ä¸ªæ‰©å±•æ·»åŠ åœ¨æ–‡ä»¶åº•éƒ¨ç±»å®šä¹‰ä»¥å¤–çš„åœ°æ–¹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - ç”¨äºç»˜åˆ¶çš„ extension</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">GraphView</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">drawRoundedRect</span><span class="params">(rect: CGRect, inContext context: CGContext?,</span></span></span><br><span class="line"><span class="function"><span class="params">                       radius: CGFloat, borderColor: CGColor, fillColor: CGColor)</span></span> &#123;</span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line">    <span class="keyword">let</span> path = <span class="type">CGMutablePath</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2</span></span><br><span class="line">    path.move( to: <span class="type">CGPoint</span>(x:  rect.midX, y:rect.minY ))</span><br><span class="line">    path.addArc( tangent1End: <span class="type">CGPoint</span>(x: rect.maxX, y: rect.minY ), </span><br><span class="line">                 tangent2End: <span class="type">CGPoint</span>(x: rect.maxX, y: rect.maxY), radius: radius)</span><br><span class="line">    path.addArc( tangent1End: <span class="type">CGPoint</span>(x: rect.maxX, y: rect.maxY ), </span><br><span class="line">                 tangent2End: <span class="type">CGPoint</span>(x: rect.minX, y: rect.maxY), radius: radius)</span><br><span class="line">    path.addArc( tangent1End: <span class="type">CGPoint</span>(x: rect.minX, y: rect.maxY ), </span><br><span class="line">                 tangent2End: <span class="type">CGPoint</span>(x: rect.minX, y: rect.minY), radius: radius)</span><br><span class="line">    path.addArc( tangent1End: <span class="type">CGPoint</span>(x: rect.minX, y: rect.minY ), </span><br><span class="line">                 tangent2End: <span class="type">CGPoint</span>(x: rect.maxX, y: rect.minY), radius: radius)</span><br><span class="line">    path.closeSubpath()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3</span></span><br><span class="line">    context?.setLineWidth(<span class="number">1.0</span>)</span><br><span class="line">    context?.setFillColor(fillColor)</span><br><span class="line">    context?.setStrokeColor(borderColor)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 4</span></span><br><span class="line">    context?.addPath(path)</span><br><span class="line">    context?.drawPath(using: .fillStroke)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¤ªé•¿ä¸çœ‹ğŸ™„ï¸ï¼šä»¥ä¸Š<strong>å°±</strong>æ˜¯ç»˜åˆ¶ä¸€ä¸ªåœ†è§’çŸ©å½¢çš„æ–¹æ³•ï¼Œç”¨äººç±»èƒ½ç†è§£çš„è¯­è¨€è§£é‡Šä¸€éå°±æ˜¯ï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªå¯ä»¥æ”¹å˜çš„è·¯å¾„ï¼›</li>
<li>ä¸€æ­¥ä¸€æ­¥å‹¾å‹’å‡ºä¸€ä¸ªåœ†è§’çŸ©å½¢ï¼š<ul>
<li>ç§»åŠ¨åˆ°çŸ©å½¢åº•è¾¹çš„ä¸­ç‚¹ï¼Œè¿™é‡Œå°†æ˜¯æˆ‘ä»¬çš„èµ·ç‚¹ï¼›</li>
<li>ä½¿ç”¨ <code>addArc(tangent1End:tangent2End:radius)</code> æ–¹æ³•ç»˜åˆ¶å³ä¸‹è§’çš„çº¿æ®µï¼Œè¿™ä¸ªæ–¹æ³•ä¼šç»˜åˆ¶å‡ºåº•éƒ¨çš„æ°´å¹³çº¿ä»¥åŠå³ä¸‹è§’çš„åœ†è§’ï¼›</li>
<li>æ·»åŠ å³è¾¹çš„çº¿æ®µå’Œå³ä¸Šè§’çš„åœ†è§’ï¼›</li>
<li>æ·»åŠ é¡¶éƒ¨çš„çº¿æ®µå’Œå·¦ä¸Šè§’çš„åœ†è§’ï¼›</li>
<li>æ·»åŠ å·¦è¾¹çš„çº¿æ®µå’Œå·¦ä¸‹è§’çš„åœ†è§’ï¼›</li>
<li>é—­åˆè·¯å¾„ï¼Œä¹Ÿå°±æ˜¯ä»ä¸Šä¸€æ­¥çš„é‡ç‚¹è¿æ¥åˆ°èµ·ç‚¹ï¼›</li>
</ul>
</li>
<li>è®¾ç½®ç»˜åˆ¶å±æ€§ï¼šçº¿å®½ã€å¡«å……é¢œè‰²å’Œè¾¹æ¡†é¢œè‰²ï¼›</li>
<li>æŠŠè·¯å¾„æ·»åŠ åˆ°å›¾å½¢ä¸Šä¸‹æ–‡ï¼Œå¹¶ä½¿ç”¨ <code>.fillStroke</code> å‚æ•°ç»˜åˆ¶ç€ä¸ªè·¯å¾„ï¼Œè¿™ä¸ªå‚æ•°å°†ä¼šå‘Šè¯‰ Core Graphics è¿™æ¡è·¯å¾„éœ€è¦å¡«å……é¢œè‰²å¹¶ç»˜åˆ¶è¾¹æ¡†ã€‚</li>
</ol>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-11f0c635e8e2e781.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="è®¡ç®—ä½ç½®"><a href="#è®¡ç®—ä½ç½®" class="headerlink" title="è®¡ç®—ä½ç½®"></a>è®¡ç®—ä½ç½®</h2><p>ä½¿ç”¨ Core Graphics è¿›è¡Œç»˜åˆ¶çš„è¿‡ç¨‹å…¶å®å°±æ˜¯è®¡ç®—å„ä¸ªè§†è§‰å…ƒç´ åœ¨è§†å›¾ä¸­ä½ç½®çš„è¿‡ç¨‹ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å…³å¿ƒçš„å°±æ˜¯æŠŠä¸åŒçš„å…ƒç´ æ”¾ç½®åœ¨å“ªï¼Œä»¥åŠå½“è§†å›¾çš„å¤§å°å‘ç”Ÿå˜åŒ–æ—¶å®ƒä»¬è¯¥å¦‚ä½•åº”å¯¹ã€‚</p>
<p>æˆ‘ä»¬å‡†å¤‡è¿™æ ·å¸ƒå±€æˆ‘ä»¬çš„è§†å›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-c03336233ad3ca43.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>æ‰“å¼€ <strong>GraphView.swift</strong> å¹¶æ·»åŠ è¿™ä¸ªæ‰©å±•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - ç”¨äºè®¡ç®—çš„ extension</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">GraphView</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 1</span></span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">pieChartRectangle</span><span class="params">()</span></span> -&gt; <span class="type">CGRect</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> width = bounds.size.width * <span class="type">Constants</span>.pieChartWidthPercentage - <span class="number">2</span> * <span class="type">Constants</span>.marginSize</span><br><span class="line">    <span class="keyword">let</span> height = bounds.size.height - <span class="number">2</span> * <span class="type">Constants</span>.marginSize</span><br><span class="line">    <span class="keyword">let</span> diameter = <span class="built_in">max</span>(<span class="built_in">min</span>(width, height), <span class="type">Constants</span>.pieChartMinRadius)</span><br><span class="line">    <span class="keyword">let</span> rect = <span class="type">CGRect</span>(x: <span class="type">Constants</span>.marginSize,</span><br><span class="line">                      y: bounds.midY - diameter / <span class="number">2.0</span>,</span><br><span class="line">                      width: diameter, height: diameter)</span><br><span class="line">    <span class="keyword">return</span> rect</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 2</span></span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">barChartRectangle</span><span class="params">()</span></span> -&gt; <span class="type">CGRect</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> pieChartRect = pieChartRectangle()</span><br><span class="line">    <span class="keyword">let</span> width = bounds.size.width - pieChartRect.maxX - <span class="number">2</span> * <span class="type">Constants</span>.marginSize</span><br><span class="line">    <span class="keyword">let</span> rect = <span class="type">CGRect</span>(x: pieChartRect.maxX + <span class="type">Constants</span>.marginSize,</span><br><span class="line">                      y: pieChartRect.midY + <span class="type">Constants</span>.marginSize,</span><br><span class="line">                      width: width, height: barHeight)</span><br><span class="line">    <span class="keyword">return</span> rect</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 3</span></span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">barChartLegendRectangle</span><span class="params">()</span></span> -&gt; <span class="type">CGRect</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> barchartRect = barChartRectangle()</span><br><span class="line">    <span class="keyword">let</span> rect = barchartRect.offsetBy(dx: <span class="number">0.0</span>, dy: -(barchartRect.size.height + <span class="type">Constants</span>.marginSize))</span><br><span class="line">    <span class="keyword">return</span> rect</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä»£ç åšäº†è¿™äº›å¿…è¦çš„è®¡ç®—ï¼š</p>
<ol>
<li>ä»è®¡ç®—é¥¼å›¾çš„ä½ç½®å¼€å§‹å…¥æ‰‹ï¼Œå®ƒå°†ä¼šå‚ç›´å±…ä¸­ï¼Œå¹¶å æ®è§†å›¾ 1/3 çš„å®½åº¦ï¼›</li>
<li>è®¡ç®—æ¡å½¢å›¾çš„ä½ç½®ï¼Œå®ƒå°†ä¼šå æ® 2/3 çš„å®½åº¦ï¼Œå¹¶å¤„äºè§†å›¾ä¸­éƒ¨åä¸Šçš„ä½ç½®ï¼›</li>
<li>æ ¹æ®é¥¼å›¾çš„æœ€å° Y å€¼å’Œè¾¹è·æ¥è®¡ç®—å›¾ä¾‹çš„ä½ç½®ã€‚</li>
</ol>
<p>ç°åœ¨æˆ‘ä»¬æ¥æŠŠæŠŠå®ƒç»˜åˆ¶åˆ°ä½ çš„è§†å›¾ä¸­å»ï¼Œåœ¨ <code>GraphView</code> çš„ç”¨äºç»˜åˆ¶çš„æ‰©å±•ä¸­åŠ å…¥ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">drawBarGraphInContext</span><span class="params">(context: CGContext?)</span></span> &#123;</span><br><span class="line">  <span class="keyword">let</span> barChartRect = barChartRectangle()</span><br><span class="line">  drawRoundedRect(rect: barChartRect, inContext: context,</span><br><span class="line">                  radius: <span class="type">Constants</span>.barChartCornerRadius,</span><br><span class="line">                  borderColor: barChartAvailableLineColor.cgColor,</span><br><span class="line">                  fillColor: barChartAvailableFillColor.cgColor)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ éœ€è¦ä¸€ä¸ª Helper æ–¹æ³•æ¥ç»˜åˆ¶æ¡å½¢å›¾ï¼Œå®ƒä¼šç»˜åˆ¶ä¸€ä¸ªåœ†è§’çŸ©å½¢ï¼Œå¹¶ä½¿ç”¨ç”»ç¬”é¢œè‰²å’Œå¡«å……é¢œè‰²åœ¨ç©ºç™½å¤„ç»˜åˆ¶å›¾å½¢ï¼Œä½ å¯ä»¥åœ¨ <strong>NSColor+DiskInfo</strong> æ‰©å±•ä¸­æ‰¾åˆ°è¿™ä¸ªäº›é¢œè‰²ã€‚</p>
<p>æŠŠ <code>draw(_:)</code> æ–¹æ³•é‡Œçš„æ‰€æœ‰ä»£ç æ›¿æ¢æˆï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">super</span>.draw(dirtyRect)</span><br><span class="line">      </span><br><span class="line"><span class="keyword">let</span> context = <span class="type">NSGraphicsContext</span>.current()?.cgContext</span><br><span class="line">drawBarGraphInContext(context: context)</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä¼šçœŸæ­£åœ°æŠŠå›¾å½¢ç»˜åˆ¶åˆ°è§†å›¾ä¸­å»ã€‚é¦–å…ˆï¼Œé€šè¿‡è°ƒç”¨ <code>NSGraphicsContext.current()</code>ï¼Œæˆ‘ä»¬è·å–åˆ°äº†å½“å‰è§†å›¾çš„å›¾å½¢ä¸Šä¸‹æ–‡ï¼Œç„¶åæˆ‘ä»¬è°ƒç”¨åˆšåˆšç¼–å†™çš„æ–¹æ³•ç»˜åˆ¶å‡ºäº†æ¡å½¢å›¾ã€‚</p>
<p>ç¼–è¯‘å¹¶è¿è¡Œï¼Œä½ å¯ä»¥çœ‹åˆ°æ¡å½¢å›¾å·²ç»å°±ä½äº†ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-0d2de8a91a09b0bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>ç°åœ¨ï¼Œæ‰“å¼€ <strong>Main.storyboard</strong> å¹¶é€‰ä¸­ <strong>View Controller Scene</strong>ï¼Œ ä½ ä¼šçœ‹åˆ°è¿™ä¸ªï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-b066eae14cf2949c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>Interface Builder ä¸ºä½ å®æ—¶æ¸²æŸ“äº†é¢„è§ˆã€‚ä½ å¯ä»¥è¯•ç€å»ä¿®æ”¹ä¸€ä¸‹é¢œè‰²ï¼Œå®ƒä¹Ÿä¼šå®æ—¶å“åº”ä½ çš„ä¿®æ”¹ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ£’æ£’å‘€ğŸ˜„ï½</p>
<h1 id="å‰ªåˆ‡ä¸€éƒ¨åˆ†åŒºåŸŸï¼ˆä¹Ÿå°±æ˜¯è’™ç‰ˆï¼‰"><a href="#å‰ªåˆ‡ä¸€éƒ¨åˆ†åŒºåŸŸï¼ˆä¹Ÿå°±æ˜¯è’™ç‰ˆï¼‰" class="headerlink" title="å‰ªåˆ‡ä¸€éƒ¨åˆ†åŒºåŸŸï¼ˆä¹Ÿå°±æ˜¯è’™ç‰ˆï¼‰"></a>å‰ªåˆ‡ä¸€éƒ¨åˆ†åŒºåŸŸï¼ˆä¹Ÿå°±æ˜¯è’™ç‰ˆï¼‰</h1><p>ç°åœ¨æˆ‘ä»¬æ¥åˆ¶ä½œæ–‡ä»¶åˆ†å¸ƒå›¾ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªå®¶ä¼™ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-81d4bc8182f1d863.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>å…ˆæš‚åœä¸€ä¸‹ä¸‹ï¼Œæˆ‘ä»¬æ¥ç†ç†æ€è·¯ã€‚æ˜¾è€Œæ˜“è§çš„æ˜¯ï¼Œæ¯ç§æ–‡ä»¶éƒ½æœ‰è‡ªå·±çš„ä¸“å±é¢œè‰²ï¼Œæˆ‘ä»¬çš„ app åªéœ€è¦æ ¹æ®è¿™ç§æ–‡ä»¶å ç¡¬ç›˜ç©ºé—´å¤§å°çš„ç™¾åˆ†æ¯”æ¥è®¡ç®—æ¯ä¸ªæ–¹å—çš„å®½åº¦ï¼Œç„¶åç”¨å¯¹åº”çš„é¢œè‰²æŠŠå®ƒç»˜åˆ¶å‡ºæ¥ã€‚</p>
<p>ä½ éœ€è¦ç»˜åˆ¶ä¸€ä¸ªä¸è§„åˆ™çš„å›¾å½¢ï¼Œæ¯”å¦‚ä¸€ä¸ª!@#Â¥%%ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªå« <strong>clipping areasï¼ˆè’™æ¿ï¼‰</strong> çš„æŠ€æœ¯æ¥é¿å…ç¼–å†™é‡å¤ä»£ç ã€‚</p>
<blockquote>
<p>ğŸ‘†è¿™ä¸€æ®µçš„ç¬¬ä¸€å¥å®åœ¨æ²¡çœ‹æ‡‚ï¼Œæ±‚æŒ‡æ­£ï¼šYou could create a special shape, such as a filled rectangle with two lines at bottom and top of the rectangleã€‚</p>
</blockquote>
<p>ä½ å¯ä»¥æŠŠè’™ç‰ˆæƒ³è±¡æˆã€Œåœ¨ä¸€å¼ çº¸ä¸Šå‰ªäº†ä¸ªçªŸçª¿ã€ï¼Œä½ åªèƒ½é€è¿‡è¿™ä¸ªçªŸçª¿çœ‹åˆ°éƒ¨åˆ†çš„å›¾å½¢ã€‚è¿™ä¸ªã€ŒçªŸçª¿ã€å°±å«åšã€ŒClipping Maskï¼ˆå‰ªåˆ‡è’™ç‰ˆï¼‰ã€ï¼Œä½ éœ€è¦åœ¨ Core Graphics é‡Œå®šä¹‰å®ƒã€‚</p>
<p>åœ¨è¿™ä¸ªæ¡å½¢å›¾çš„ä¾‹å­é‡Œï¼Œä½ éœ€è¦ä¸ºæ¯ç§æ–‡ä»¶åˆ†ç±»åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„åœ†è§’çŸ©å½¢ï¼Œç„¶åé€šè¿‡å‰ªåˆ‡è’™ç‰ˆæ¥ä½¿å®ƒä»¬åªæ˜¾ç¤ºæ­£ç¡®çš„éƒ¨åˆ†ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-a87e7ca09027a440.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>ç†è®ºè¯´å®Œäº†ï¼Œæˆ‘ä»¬æ¥åŠ¨æ‰‹å§ï½</p>
<p>å¼€æ”¯ç»˜åˆ¶ä¹‹å‰ï¼Œä½ éœ€è¦ä¸ºé€‰ä¸­çš„ç¡¬ç›˜è®¾ç½® <code>fileDistribution</code>ã€‚æ‰“å¼€ <strong>Main.storyboard</strong>ï¼Œæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ª Outlet è¿æ¥ã€‚</p>
<p>åœ¨é¡¹ç›®å¯¼èˆªå™¨é‡ŒæŒ‰ä½ <strong>OptionâŒ¥ é”®</strong>çš„åŒæ—¶ç‚¹å‡» <strong>ViewController.swift</strong>ï¼Œä½¿å®ƒæ˜¾ç¤ºåœ¨å³åŠè¾¹çš„<strong>ååŠ©ç¼–è¾‘å™¨</strong>é‡Œï¼Œç„¶åæŒ‰ä½ <strong>ControlâŒƒ é”®</strong>çš„åŒæ—¶æŠŠ Graph View æ‹–åŠ¨åˆ° View Controller çš„ä»£ç é‡Œã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-bfc8259a9457f83f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>åœ¨å¼¹å‡ºçš„å°æ°”æ³¡é‡Œï¼ŒæŠŠè¿™ä¸ª Outlet å‘½åä¸º <code>graphView</code>ï¼Œå¹¶ç‚¹å‡» <strong>Connect</strong>ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-a1d8f29e9ccf8ff1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>æ‰“å¼€ <strong>ViewController.swift</strong> å¹¶æŠŠè¿™è¡Œä»£ç æ·»åŠ åˆ° <code>showVolumeInfo(_:)</code> çš„æœ«å°¾ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">graphView.fileDistribution = volume.fileDistribution</span><br></pre></td></tr></table></figure>
<p>è¿™è¡Œä»£ç è®¾ç½®äº† <code>fileDistribution</code> çš„å€¼ï¼Œä»è€Œè®© Graph View èƒ½è·å–å„ç±»æ–‡ä»¶å çš„ç™¾åˆ†æ¯”ã€‚</p>
<p>æ‰“å¼€ <strong>GraphView.swift</strong>ï¼ŒæŠŠè¿™äº›ä»£ç æ·»åŠ åˆ° <code>drawBarGraphInContext(context:)</code> çš„æœ«å°¾æ¥ç»˜åˆ¶æ¡å½¢å›¾ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> fileTypes = fileDistribution?.distribution, <span class="keyword">let</span> capacity = fileDistribution?.capacity, capacity &gt; <span class="number">0</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> clipRect = barChartRect</span><br><span class="line">  <span class="comment">// 2</span></span><br><span class="line">  <span class="keyword">for</span> (index, fileType) <span class="keyword">in</span> fileTypes.enumerated() &#123;</span><br><span class="line">    <span class="comment">// 3</span></span><br><span class="line">    <span class="keyword">let</span> fileTypeInfo = fileType.fileTypeInfo</span><br><span class="line">    <span class="keyword">let</span> clipWidth = floor(barChartRect.width * <span class="type">CGFloat</span>(fileTypeInfo.percent))</span><br><span class="line">    clipRect.size.width = clipWidth</span><br><span class="line">        </span><br><span class="line">    <span class="comment">// 4</span></span><br><span class="line">    context?.saveGState()</span><br><span class="line">    context?.clip(to: clipRect)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> fileTypeColors = colorsForFileType(fileType: fileType)</span><br><span class="line">    drawRoundedRect(rect: barChartRect, inContext: context,</span><br><span class="line">                    radius: <span class="type">Constants</span>.barChartCornerRadius,</span><br><span class="line">                    borderColor: fileTypeColors.strokeColor.cgColor,</span><br><span class="line">                    fillColor: fileTypeColors.fillColor.cgColor)</span><br><span class="line">    context?.restoreGState()</span><br><span class="line">        </span><br><span class="line">    <span class="comment">// 5</span></span><br><span class="line">    clipRect.origin.x = clipRect.maxX</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™äº›ä»£ç åšäº†è¿™äº›äº‹å„¿ï¼š</p>
<ol>
<li>å…ˆç¡®ä¿äº† Graph View æ‹¥æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„ <code>fileDistribution</code>ï¼›</li>
<li>éå† <code>fileDistribution</code> é‡Œçš„æ¯ä¸€ç§æ–‡ä»¶ç±»å‹ï¼›</li>
<li>æ ¹æ®æ–‡ä»¶çš„å æ¯”è®¡ç®—è’™ç‰ˆçš„å¤§å°ï¼›</li>
<li>å­˜å‚¨å›¾å½¢ä¸Šä¸‹æ–‡çš„çŠ¶æ€ï¼Œè®¾ç½®è’™ç‰ˆçš„å¤§å°ï¼Œç”¨æ–‡ä»¶ç±»å‹å¯¹åº”çš„é¢œè‰²ç»˜åˆ¶åœ†è§’çŸ©å½¢ï¼Œå¹¶æ¢å¤å›¾å½¢ä¸Šä¸‹æ–‡çš„çŠ¶æ€ï¼›</li>
<li>æŠŠå‰ªåˆ‡è’™ç‰ˆçš„ <strong>x</strong> ç§»åŠ¨åˆ°æ­£ç¡®çš„ä½ç½®ã€‚</li>
</ol>
<p>ä½ å¯èƒ½ä¼šå¥‡æ€ªï¼šä¸ºä»€ä¹ˆè¦å…ˆå­˜å‚¨ï¼Œå†æ¢å¤å›¾å½¢ä¸Šä¸‹æ–‡ï¼Ÿè¿˜è®°å¾—ã€Œpainterâ€™s modelã€å—ï¼Ÿä½ æ·»åŠ åˆ°å›¾å½¢ä¸Šä¸‹æ–‡é‡Œçš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šè¢«ä¿å­˜åœ¨ä¸Šä¸‹æ–‡ä¸­ï¼Œå°±åƒä½ ç”»åœ¨çº¸ä¸Šçš„ç”»ï¼Œä¼šä¸€ç›´åœ¨é‚£é‡Œã€‚</p>
<p>å¦‚æœä½ æ·»åŠ äº†å¤šä¸ªå‰ªåˆ‡è’™ç‰ˆï¼Œäº‹å®ä¸Šä½ æ˜¯åªåˆ›å»ºäº†ä¸€ä¸ªå‰ªåˆ‡è’™ç‰ˆï¼Œå¹¶åº”ç”¨åˆ°æ‰€æœ‰çŸ©å½¢ä¸Šã€‚è¦é¿å…è¿™ç§æƒ…å†µï¼Œä½ éœ€è¦åœ¨æ·»åŠ æ–°çš„å‰ªåˆ‡è’™ç‰ˆä¹‹å‰å­˜å‚¨ä¸Šä¸‹æ–‡çš„çŠ¶æ€ï¼Œç­‰ä½ ä½¿ç”¨å®Œäº†è¿™ä¸ªè’™ç‰ˆï¼Œå†æŠŠå®ƒæ¢å¤å‡ºæ¥ï¼Œå†å¤„ç†æ–°çš„è’™ç‰ˆã€‚</p>
<p>æ­¤æ—¶ï¼Œ<strong>Xcode</strong> ä¼šå¼¹å‡ºä¸€ä¸ªè­¦å‘Šï¼Œå› ä¸º <code>index</code> ä»æ²¡è¢«ä½¿ç”¨è¿‡ã€‚åˆ«æ‹…å¿ƒï¼Œå®ƒçš„å¾…ä¼šå„¿å°±ä¼šæ´¾ä¸Šç”¨åœºã€‚</p>
<p>ç¼–è¯‘å¹¶è¿è¡Œï¼Œæˆ–è€…ç›´æ¥æ‰“å¼€ <strong>Main.storyboard</strong>ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-53339621371d124f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>å“ˆå“ˆï¼ŒDiskInfo åŠŸèƒ½ä¼¼ä¹å·²ç»æ¸æ¸å®Œå–„äº†å‘¢ï½é™¤äº†å›¾ä¾‹ï¼Œè¿™ä¸ªæ¡å½¢å›¾å·²ç»åŸºæœ¬å®Œå·¥äº†ğŸ‘ã€‚</p>
<h2 id="ç»˜åˆ¶æ–‡æœ¬"><a href="#ç»˜åˆ¶æ–‡æœ¬" class="headerlink" title="ç»˜åˆ¶æ–‡æœ¬"></a>ç»˜åˆ¶æ–‡æœ¬</h2><p>åœ¨è‡ªå®šä¹‰è§†å›¾é‡Œç»˜åˆ¶æ–‡æœ¬ç‰¹åˆ«ç®€å•ï¼Œä½ éœ€è¦ä¸ºè¿™ä¸ªæ–‡æœ¬çš„å„ç§å±æ€§åˆ›å»ºä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«äº†å­—ä½“ã€å°ºå¯¸ã€é¢œè‰²å’Œå¯¹é½ï¼ŒæŠŠå®ƒä¼ å…¥ <code>String</code> çš„ <code>draw(in:withAttributes:)</code> æ–¹æ³•ã€‚è¿™äº›å±æ€§å°†ä¼šåœ¨æˆ‘ä»¬è®¡ç®—çŸ©å½¢å¤§å°å’Œä½ç½®çš„æ—¶å€™æ´¾ä¸Šç”¨åœºã€‚</p>
<p>æ‰“å¼€ <strong>GraphView.swift</strong>ï¼ŒæŠŠè¿™ä¸ªå±æ€§æ·»åŠ åˆ°ç±»çš„å®šä¹‰é‡Œï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fileprivate</span> <span class="keyword">var</span> bytesFormatter = <span class="type">ByteCountFormatter</span>()</span><br></pre></td></tr></table></figure>
<p>è¿™å°†ä¼šåˆ›å»ºä¸€ä¸ª <strong>ByteCountFormatter</strong>ã€‚å®ƒä¼šå¸®æˆ‘ä»¬å®Œæˆã€ŒæŠŠå­—èŠ‚è½¬åŒ–æˆäººè¯ã€è¿™ä¸ªé«˜æ·±è€Œç¹é‡çš„å·¥ä½œã€‚</p>
<p>ç°åœ¨ï¼Œåœ¨ <code>drawBarGraphInContext(context:)</code> æ–¹æ³•çš„ <code>for (index,fileType) in fileTypes.enumerated()</code> å¾ªç¯é‡ŒåŠ å…¥è¿™äº›ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="keyword">let</span> legendRectWidth = (barChartRect.size.width / <span class="type">CGFloat</span>(fileTypes.<span class="built_in">count</span>))</span><br><span class="line"><span class="keyword">let</span> legendOriginX = barChartRect.origin.x + floor(<span class="type">CGFloat</span>(index) * legendRectWidth)</span><br><span class="line"><span class="keyword">let</span> legendOriginY = barChartRect.minY - <span class="number">2</span> * <span class="type">Constants</span>.marginSize</span><br><span class="line"><span class="keyword">let</span> legendSquareRect = <span class="type">CGRect</span>(x: legendOriginX, y: legendOriginY,</span><br><span class="line">                              width: <span class="type">Constants</span>.barChartLegendSquareSize,</span><br><span class="line">                              height: <span class="type">Constants</span>.barChartLegendSquareSize)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> legendSquarePath = <span class="type">CGMutablePath</span>()</span><br><span class="line">legendSquarePath.addRect( legendSquareRect )</span><br><span class="line">context?.addPath(legendSquarePath)</span><br><span class="line">context?.setFillColor(fileTypeColors.fillColor.cgColor)</span><br><span class="line">context?.setStrokeColor(fileTypeColors.strokeColor.cgColor)</span><br><span class="line">context?.drawPath(using: .fillStroke)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="keyword">let</span> paragraphStyle = <span class="type">NSMutableParagraphStyle</span>()</span><br><span class="line">paragraphStyle.lineBreakMode = .byTruncatingTail</span><br><span class="line">paragraphStyle.alignment = .<span class="keyword">left</span></span><br><span class="line"><span class="keyword">let</span> nameTextAttributes = [</span><br><span class="line">  <span class="type">NSFontAttributeName</span>: <span class="type">NSFont</span>.barChartLegendNameFont,</span><br><span class="line">  <span class="type">NSParagraphStyleAttributeName</span>: paragraphStyle]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="keyword">let</span> nameTextSize = fileType.name.size(withAttributes: nameTextAttributes)</span><br><span class="line"><span class="keyword">let</span> legendTextOriginX = legendSquareRect.maxX + <span class="type">Constants</span>.legendTextMargin</span><br><span class="line"><span class="keyword">let</span> legendTextOriginY = legendOriginY - <span class="number">2</span> * <span class="type">Constants</span>.pieChartBorderWidth</span><br><span class="line"><span class="keyword">let</span> legendNameRect = <span class="type">CGRect</span>(x: legendTextOriginX, y: legendTextOriginY,</span><br><span class="line">                            width: legendRectWidth - legendSquareRect.size.width - <span class="number">2</span> *</span><br><span class="line">                              <span class="type">Constants</span>.legendTextMargin,</span><br><span class="line">                            height: nameTextSize.height)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4</span></span><br><span class="line">fileType.name.draw(<span class="keyword">in</span>: legendNameRect, withAttributes: nameTextAttributes)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5</span></span><br><span class="line"><span class="keyword">let</span> bytesText = bytesFormatter.string(fromByteCount: fileTypeInfo.bytes)</span><br><span class="line"><span class="keyword">let</span> bytesTextAttributes = [</span><br><span class="line">  <span class="type">NSFontAttributeName</span>: <span class="type">NSFont</span>.barChartLegendSizeTextFont,</span><br><span class="line">  <span class="type">NSParagraphStyleAttributeName</span>: paragraphStyle,</span><br><span class="line">  <span class="type">NSForegroundColorAttributeName</span>: <span class="type">NSColor</span>.secondaryLabelColor]</span><br><span class="line"><span class="keyword">let</span> bytesTextSize = bytesText.size(withAttributes: bytesTextAttributes)</span><br><span class="line"><span class="keyword">let</span> bytesTextRect = legendNameRect.offsetBy(dx: <span class="number">0.0</span>, dy: -bytesTextSize.height)</span><br><span class="line">bytesText.draw(<span class="keyword">in</span>: bytesTextRect, withAttributes: bytesTextAttributes)</span><br></pre></td></tr></table></figure>
<p>çœ‹èµ·æ¥è¿™ä¸€å¤§å †ä»£ç è¿˜æŒºå”¬äººçš„ï¼Œå…¶å®å¾ˆç®€å•ï¼š</p>
<ol>
<li>ä½ å·²ç»å¾ˆç†Ÿæ‚‰è¿™ä¸€æ®µä»£ç äº†ï¼šè®¡ç®—å›¾ä¾‹çš„å½©è‰²æ–¹å—çš„ä½ç½®ï¼Œä¸ºå®ƒåˆ›å»ºä¸€æ¡è·¯å¾„ï¼Œå¹¶ç”¨å¯¹åº”çš„é¢œè‰²å¡«å……ï¼›</li>
<li>åˆ›å»ºä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«äº†ä¸¤ä¸ªå±æ€§ï¼šå­—ä½“å’Œ <code>NSMutableParagraphStyle</code>ã€‚åè€…ä¼šå®šä¹‰è¿™äº›æ–‡æœ¬ä¼šæ€æ ·åœ¨ç»™å®šçš„çŸ©å½¢é‡Œè¢«ç»˜åˆ¶å‡ºæ¥ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ–‡æœ¬ä¼šæ˜¾ç¤ºä¸ºå·¦å¯¹é½ï¼Œä¸”è‹¥æ–‡æœ¬è¶…å‡ºäº†çŸ©å½¢èŒƒå›´ï¼Œç³»ç»Ÿä¼šåœ¨ä»–çš„æœ«å°¾åŠ ä¸Šçœç•¥å·ï¼›</li>
<li>è®¡ç®—ç”¨äºç»˜åˆ¶æ–‡æœ¬çš„çŸ©å½¢çš„ä½ç½®å’Œå¤§å°ï¼›</li>
<li>è°ƒç”¨ <code>draw(in:withAttributes:)</code>ï¼Œç»˜åˆ¶æ–‡æœ¬ï¼›</li>
<li>ä½¿ç”¨ <code>bytesFormatter</code> è·å–æ–‡æœ¬ï¼Œå¹¶è®¾ç½®ã€Œæ–‡ä»¶å¤§å°ã€çš„æ–‡æœ¬çš„å±æ€§ã€‚è¿™å’Œä¹‹å‰å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼šè¿™ä¸ªæ–‡æœ¬ç”¨ <code>NSFontAttributeName</code> è®¾ç½®äº†ä¸€ä¸ªä¸åŒçš„é¢œè‰²ã€‚</li>
</ol>
<p>ç¼–è¯‘å¹¶è¿è¡Œï¼Œæˆ–è€…å‰å¾€ <strong>Main.storyboard</strong>ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-bf60da1d58848b16.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>çƒ­çƒˆç¥è´ºæ¡å½¢å›¾æ€é’æˆåŠŸï¼ä½ ç°åœ¨å¯ä»¥è°ƒæ•´ä¸€ä¸‹çª—å£çš„å¤§å°ï¼Œçœ‹çœ‹å›¾ä¾‹é‡Œçš„æ–‡æœ¬æ—¶å¦‚ä½•ç»™è‡ªå·±åŠ ä¸Šçœç•¥å·æ¥é€‚åº”ç‹­å°çš„ç©ºé—´çš„ã€‚</p>
<p>ç»™è‡ªå·±é¼“ä¸ªæŒå§ğŸ‘ï½</p>
<h1 id="Cocoa-Drawing"><a href="#Cocoa-Drawing" class="headerlink" title="Cocoa Drawing"></a>Cocoa Drawing</h1><p><strong>macOS</strong> è¿˜æä¾›äº†ä½¿ç”¨ <strong>AppKit</strong> çš„æ¡†æ¶æ¥è¿›è¡Œç»˜åˆ¶çš„é€‰é¡¹ã€‚å®ƒå°†ä¼šæä¾›æ›´é«˜å±‚çš„æŠ½è±¡ç»˜å›¾æ³•ã€‚å®ƒä½¿ç”¨å„ç§ç±»æ¥ä»£æ›¿ <strong>C è¯­è¨€</strong>çš„å‡½æ•°ï¼Œå®ƒè¿˜åŒ…å«äº†è®¸å¤š Helper æ–¹æ³•æ¥æ›´è½»æ¾åœ°åº”å¯¹å¸¸è§ç»˜å›¾ä»»åŠ¡ã€‚åœ¨ä¸¤ä¸ªæ¡†æ¶ä¸­ï¼Œå›¾å½¢ä¸Šä¸‹æ–‡æ˜¯ä¸€æ ·çš„ã€‚å¦‚æœä½ å¯¹ Core Graphics å¾ˆç†Ÿæ‚‰çš„è¯ï¼Œä½ åº”è¯¥èƒ½å¾ˆè½»æ¾åœ°æŒæ¡ Cocoa Drawingã€‚</p>
<p>å’Œ Core Graphics ä¸€æ ·ï¼Œä½ éœ€è¦åˆ›å»ºå¹¶ç»˜åˆ¶è·¯å¾„ï¼Œä½†åœ¨ Cocoa Drawingï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>NSBezierPath</code>ï¼Œå®ƒå’Œ <code>CGPathRef</code> æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>æˆ‘ä»¬è¦ç»˜åˆ¶çš„é¥¼å›¾æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-e246d4795e5dec1b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>ä½ éœ€è¦åˆ†ä¸‰æ­¥æ¥ç»˜åˆ¶å®ƒï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-bda1ff3ab8d8e064.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<ol>
<li>åˆ›å»ºä¸€æ¡åœ†å½¢çš„è·¯å¾„ï¼Œç”¨äºæ˜¾ç¤ºæ€»ç¡¬ç›˜ç©ºé—´ï¼Œç„¶åç”¨å®šä¹‰å¥½çš„é¢œè‰²ç»˜åˆ¶å®ƒï¼›</li>
<li>ä¸ºå·²ç”¨ç©ºé—´åˆ›å»ºä¸€æ¡è·¯å¾„ï¼Œå¹¶ç»˜åˆ¶å®ƒï¼›</li>
<li>ä¸ºå·²ç”¨ç©ºé—´çš„è·¯å¾„ç»˜åˆ¶ä¸€ä¸ªæ¸å˜å¡«å……ã€‚</li>
</ol>
<p>æ‰“å¼€ <strong>GraphView.swift</strong>ï¼ŒæŠŠè¿™ä¸ªæ–¹æ³•æ·»åŠ åˆ°ç”¨äºç»˜åˆ¶çš„ extension é‡Œï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">drawPieChart</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">guard</span> <span class="keyword">let</span> fileDistribution = fileDistribution <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 1</span></span><br><span class="line">  <span class="keyword">let</span> rect = pieChartRectangle()</span><br><span class="line">  <span class="keyword">let</span> circle = <span class="type">NSBezierPath</span>(ovalIn: rect)</span><br><span class="line">  pieChartAvailableFillColor.setFill()</span><br><span class="line">  pieChartAvailableLineColor.setStroke()</span><br><span class="line">  circle.stroke()</span><br><span class="line">  circle.fill()</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 2</span></span><br><span class="line">  <span class="keyword">let</span> path = <span class="type">NSBezierPath</span>()</span><br><span class="line">  <span class="keyword">let</span> center = <span class="type">CGPoint</span>(x: rect.midX, y: rect.midY)</span><br><span class="line">  <span class="keyword">let</span> usedPercent = <span class="type">Double</span>(fileDistribution.capacity - fileDistribution.available) /</span><br><span class="line">    <span class="type">Double</span>(fileDistribution.capacity)</span><br><span class="line">  <span class="keyword">let</span> endAngle = <span class="type">CGFloat</span>(<span class="number">360</span> * usedPercent)</span><br><span class="line">  <span class="keyword">let</span> radius = rect.size.width / <span class="number">2.0</span></span><br><span class="line">  path.move(to: center)</span><br><span class="line">  path.line(to: <span class="type">CGPoint</span>(x: rect.maxX, y: center.y))</span><br><span class="line">  path.appendArc(withCenter: center, radius: radius,</span><br><span class="line">                                         startAngle: <span class="number">0</span>, endAngle: endAngle)</span><br><span class="line">  path.close()</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 3</span></span><br><span class="line">  pieChartUsedLineColor.setStroke()</span><br><span class="line">  path.stroke()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹è¿™æ®µä»£ç ï¼š</p>
<ol>
<li>ç”¨ <code>init(ovalIn:)</code> æ„é€ æ–¹æ³•åˆ›å»ºä¸€æ¡åœ†å½¢çš„è·¯å¾„ï¼Œè®¾ç½®å®ƒçš„å¡«å……é¢œè‰²å’Œç¬”è§¦é¢œè‰²ï¼Œç„¶åç»˜åˆ¶è¿™æ¡è·¯å¾„ï¼›</li>
<li>ä¸ºå·²ç”¨ç©ºé—´åˆ›å»ºä¸€æ¡è·¯å¾„ï¼š<ul>
<li>æ ¹æ®å·²ç”¨ç©ºé—´è®¡ç®—æ‰‡å½¢çš„è§’åº¦ï¼›</li>
<li>ç§»åŠ¨åˆ°å¤§åœ†çš„åœ†å¿ƒï¼›</li>
<li>æ·»åŠ ä¸€æ¡ä»åœ†å¿ƒåˆ°åœ†çš„å³é¡¶ç‚¹çš„çº¿æ®µï¼›</li>
<li>æ ¹æ®ä¹‹å‰è®¡ç®—çš„è§’åº¦æ·»åŠ ä¸€æ¡åœ†å¼§ï¼›</li>
<li>é—­åˆå›¾å½¢ï¼Œä¹Ÿå°±æ˜¯ä»åœ†å¼§çš„ç»ˆç‚¹è¿æ¥åˆ°åœ†å¿ƒï¼›</li>
</ul>
</li>
<li>è°ƒç”¨ <code>stroke()</code> æ–¹æ³•ï¼Œè®¾ç½®ç¬”è§¦é¢œè‰²ï¼›</li>
</ol>
<p>ä½ åº”è¯¥èƒ½å‘ç°è¿™æ®µä»£ç å’Œä¹‹å‰çš„åŒºåˆ«ï¼š</p>
<ul>
<li>ä»£ç ä¸­æ²¡æœ‰æåˆ°è¿‡å›¾å½¢ä¸Šä¸‹æ–‡ï¼Œå› ä¸ºæˆ‘ä»¬è°ƒç”¨çš„æ–¹æ³•ä¼šè‡ªåŠ¨è·å–å½“å‰çš„ä¸Šä¸‹æ–‡ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°±æ˜¯è§†å›¾è‡ªå·±çš„å›¾å½¢ä¸Šä¸‹æ–‡ï¼›</li>
<li>è§’æ˜¯ä»¥è§’åº¦åˆ¶è®¡ç®—ï¼Œè€Œä¸æ˜¯å¼§åº¦åˆ¶ã€‚<strong>CGFloat+Radians.swift</strong> æ‰©å±•äº† CGFloat ç±»æ¥è¿›è¡Œäº†è‡ªåŠ¨è½¬æ¢ã€‚</li>
</ul>
<p>ç°åœ¨æŠŠè¿™è¡Œä»£ç æ·»åŠ åˆ° <code>draw(_:)</code> æ–¹æ³•ä¸­æ¥ç»˜åˆ¶é¥¼å›¾ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drawPieChart()</span><br></pre></td></tr></table></figure>
<p>ç¼–è¯‘å¹¶è¿è¡Œï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-5169614dde1ef08a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>è¿›å±•ä¸é”™ï¼</p>
<h2 id="ç»˜åˆ¶æ¸å˜"><a href="#ç»˜åˆ¶æ¸å˜" class="headerlink" title="ç»˜åˆ¶æ¸å˜"></a>ç»˜åˆ¶æ¸å˜</h2><p><strong>Cocoa Drawing</strong> ä½¿ç”¨ <code>NSGradient</code> æ¥ç»˜åˆ¶æ¸å˜ã€‚</p>
<p>ä½ éœ€è¦åœ¨å·²ä½¿ç”¨çš„æ‰‡å½¢é‡Œç»˜åˆ¶æ¸å˜ï¼Œè¯¥æ€ä¹ˆå®ç°å‘¢â€¦â€¦ğŸ¤”ï¼Ÿ</p>
<p>æ²¡é”™ï¼Œç”¨å‰ªåˆ‡è’™ç‰ˆå•Šï¼</p>
<p>ä½ å·²ç»åˆ›å»ºäº†ä¸€æ¡è·¯å¾„æ¥ç»˜åˆ¶å·²ç”¨ç©ºé—´çš„æ‰‡å½¢ï¼Œåœ¨æˆ‘ä»¬ç»˜åˆ¶æ¸å˜ä¹‹å‰ï¼Œå…ˆæ¥æŠŠå®ƒç”¨ä½œå‰ªåˆ‡è’™ç‰ˆã€‚</p>
<p>æŠŠè¿™äº›ä»£ç æ·»åŠ åˆ° <code>drawPieChart()</code> æ–¹æ³•ä¸­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> gradient = <span class="type">NSGradient</span>(starting: pieChartGradientStartColor,</span><br><span class="line">                             ending: pieChartGradientEndColor) &#123;</span><br><span class="line">  gradient.draw(<span class="keyword">in</span>: path, angle: <span class="type">Constants</span>.pieChartGradientAngle)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€è¡Œä»£ç ä¼šè¯•ç€å»åˆ›å»ºä¸€ä¸ªä¸¤ç§é¢œè‰²æ„æˆçš„æ¸å˜ã€‚å¦‚æœåˆ›å»ºæˆåŠŸäº†ï¼Œå°±ä¼šè°ƒç”¨ <code>draw(in:angle:)</code> æ–¹æ³•æ¥ç»˜åˆ¶å®ƒã€‚åœ¨å¤§æ‹¬å·é‡Œï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè®¾ç½®è’™ç‰ˆï¼Œå¹¶åœ¨è’™ç‰ˆåŒºåŸŸå†…ç»˜åˆ¶æ¸å˜ã€‚æ˜¯ä¸æ˜¯ç‰¹åˆ«æ£’ï½</p>
<p>ç¼–è¯‘å¹¶è¿è¡Œï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-27ddddbb77a21564.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h1 id="ç»ƒä¹ -æŒ‘æˆ˜ï¼šç»˜åˆ¶é¥¼å›¾çš„å›¾ä¾‹"><a href="#ç»ƒä¹ -æŒ‘æˆ˜ï¼šç»˜åˆ¶é¥¼å›¾çš„å›¾ä¾‹" class="headerlink" title="ç»ƒä¹ /æŒ‘æˆ˜ï¼šç»˜åˆ¶é¥¼å›¾çš„å›¾ä¾‹"></a>ç»ƒä¹ /æŒ‘æˆ˜ï¼šç»˜åˆ¶é¥¼å›¾çš„å›¾ä¾‹</h1><p>ç°åœ¨æˆ‘ä»¬çš„è‡ªå®šä¹‰è§†å›¾å·²ç»è¶Šæ¥è¶Šå®Œç¾äº†ï¼Œä½†è¿˜æœ‰ä¸€ä¸ªå¾…åŠäº‹é¡¹ï¼šç»˜åˆ¶é¥¼å›¾çš„å›¾ä¾‹ï¼Œä¹Ÿå°±æ˜¯å…¶å†…éƒ¨çš„æ–‡å­—è¯´æ˜ã€‚</p>
<p>ä½ å·²ç»çŸ¥é“è¯¥æ€ä¹ˆå»åšäº†ï¼Œå‡†å¤‡å¥½æ¥å—æŒ‘æˆ˜äº†å˜›ğŸ’ªï¼Ÿ</p>
<p>ä¸€äº›å°æç¤ºï¼š</p>
<ol>
<li>ä½¿ç”¨ <code>bytesFormatter</code> æ¥è·å–ç¡¬ç›˜çš„å¯ç”¨ç©ºé—´ï¼ˆ<code>fileDistribution.available</code> å±æ€§ï¼‰å’Œæ€»ç©ºé—´ï¼ˆ<code>fileDistribution.capacity</code> å±æ€§ï¼‰ï¼›</li>
<li>è®¡ç®—æ–‡æœ¬çš„ä½ç½®ï¼Œç¡®ä¿ä½ çš„æ–‡æœ¬æ˜¾ç¤ºåœ¨å„ä¸ªæ‰‡å½¢çš„ä¸­å¤®ï¼›</li>
<li>åœ¨è®¡ç®—å¥½çš„ä½ç½®ç”¨ä»¥ä¸‹å±æ€§ç»˜åˆ¶æ–‡æœ¬ï¼š<ul>
<li>Fontï¼š<code>NSFont.pieChartLegendFont</code>ï¼›</li>
<li>Used space text colorï¼š<code>NSColor.pieChartUsedSpaceTextColor</code>ï¼›</li>
<li>Available space text colorï¼š<code>NSColor.pieChartAvailableSpaceTextColor</code>ã€‚  </li>
</ul>
</li>
</ol>
<h1 id="ç­”æ¡ˆï¼šç»˜åˆ¶å›¾ä¾‹"><a href="#ç­”æ¡ˆï¼šç»˜åˆ¶å›¾ä¾‹" class="headerlink" title="ç­”æ¡ˆï¼šç»˜åˆ¶å›¾ä¾‹"></a>ç­”æ¡ˆï¼šç»˜åˆ¶å›¾ä¾‹</h1><p>æŠŠè¿™äº›ä»£ç æ·»åŠ åˆ° <code>drawPieChart()</code> æ–¹æ³•ä¸­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="keyword">let</span> usedMidAngle = endAngle / <span class="number">2.0</span></span><br><span class="line"><span class="keyword">let</span> availableMidAngle = (<span class="number">360.0</span> - endAngle) / <span class="number">2.0</span></span><br><span class="line"><span class="keyword">let</span> halfRadius = radius / <span class="number">2.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="keyword">let</span> usedSpaceText = bytesFormatter.string(fromByteCount: fileDistribution.capacity)</span><br><span class="line"><span class="keyword">let</span> usedSpaceTextAttributes = [</span><br><span class="line">  <span class="type">NSFontAttributeName</span>: <span class="type">NSFont</span>.pieChartLegendFont,</span><br><span class="line">  <span class="type">NSForegroundColorAttributeName</span>: <span class="type">NSColor</span>.pieChartUsedSpaceTextColor]</span><br><span class="line"><span class="keyword">let</span> usedSpaceTextSize = usedSpaceText.size(withAttributes: usedSpaceTextAttributes)</span><br><span class="line"><span class="keyword">let</span> xPos = rect.midX + <span class="type">CGFloat</span>(cos(usedMidAngle.radians)) *</span><br><span class="line">  halfRadius - (usedSpaceTextSize.width / <span class="number">2.0</span>)</span><br><span class="line"><span class="keyword">let</span> yPos = rect.midY + <span class="type">CGFloat</span>(sin(usedMidAngle.radians)) *</span><br><span class="line">  halfRadius - (usedSpaceTextSize.height / <span class="number">2.0</span>)</span><br><span class="line">usedSpaceText.draw(at: <span class="type">CGPoint</span>(x: xPos, y: yPos),</span><br><span class="line">                   withAttributes: usedSpaceTextAttributes)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="keyword">let</span> availableSpaceText = bytesFormatter.string(fromByteCount: fileDistribution.available)</span><br><span class="line"><span class="keyword">let</span> availableSpaceTextAttributes = [</span><br><span class="line">  <span class="type">NSFontAttributeName</span>: <span class="type">NSFont</span>.pieChartLegendFont,</span><br><span class="line">  <span class="type">NSForegroundColorAttributeName</span>: <span class="type">NSColor</span>.pieChartAvailableSpaceTextColor]</span><br><span class="line"><span class="keyword">let</span> availableSpaceTextSize = availableSpaceText.size(withAttributes: availableSpaceTextAttributes)</span><br><span class="line"><span class="keyword">let</span> availableXPos = rect.midX + cos(-availableMidAngle.radians) *</span><br><span class="line">  halfRadius - (availableSpaceTextSize.width / <span class="number">2.0</span>)</span><br><span class="line"><span class="keyword">let</span> availableYPos = rect.midY + sin(-availableMidAngle.radians) *</span><br><span class="line">  halfRadius - (availableSpaceTextSize.height / <span class="number">2.0</span>)</span><br><span class="line">availableSpaceText.draw(at: <span class="type">CGPoint</span>(x: availableXPos, y: availableYPos),</span><br><span class="line">                        withAttributes: availableSpaceTextAttributes)</span><br></pre></td></tr></table></figure>
<p>ä»£ç å«ä¹‰ï¼š</p>
<ol>
<li>è®¡ç®—ä¸¤ä¸ªåŒºåŸŸçš„è§’åº¦ï¼›</li>
<li>åˆ›å»ºå·²ç”¨ç©ºé—´çš„æ–‡æœ¬çš„å±æ€§ï¼Œå¹¶è®¡ç®—å…¶ <em>x</em> å’Œ <em>y</em>ï¼Œç„¶åç»˜åˆ¶å®ƒï¼›</li>
<li>åˆ›å»ºæ€»ç©ºé—´çš„æ–‡æœ¬çš„å±æ€§ï¼Œå¹¶è®¡ç®—å…¶ <em>x</em> å’Œ <em>y</em>ï¼Œç„¶åç»˜åˆ¶å®ƒï¼›</li>
</ol>
<p>ç°åœ¨ï¼Œç¼–è¯‘å¹¶è¿è¡Œä½ çš„ appï¼Œå¥½å¥½æ¬£èµä¸€ä¸‹ä½ çš„æ°å‡ºä½œå“ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5477931-2b67c2e23ffc4526.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>æ­å–œä½ ï¼ä½ ä½¿ç”¨ Core Graphics å’Œ Cocoa Drawing åˆ›å»ºäº†ä¸€ä¸ªç¾ä¸½çš„ appï¼</p>
<h1 id="æ¥ä¸‹æ¥è¯¥åšå•¥ï¼Ÿ"><a href="#æ¥ä¸‹æ¥è¯¥åšå•¥ï¼Ÿ" class="headerlink" title="æ¥ä¸‹æ¥è¯¥åšå•¥ï¼Ÿ"></a>æ¥ä¸‹æ¥è¯¥åšå•¥ï¼Ÿ</h1><p>ä½ å¯ä»¥<a href="https://koenig-media.raywenderlich.com/uploads/2016/06/DiskInfo-Final.zip" target="_blank" rel="noopener">ç‚¹å‡»è¿™é‡Œ</a>ä¸‹è½½å®Œæ•´çš„å·¥ç¨‹æ–‡ä»¶ã€‚</p>
<p>è¿™ä¸ª macOS Core Graphics æ•™ç¨‹è¦†ç›–äº† macOS ä¸­ç”¨äºç»˜åˆ¶è‡ªå®šä¹‰è§†å›¾çš„ä¸åŒæ¡†æ¶çš„åŸºæœ¬çŸ¥è¯†ï¼š</p>
<ul>
<li>å¦‚ä½•ä½¿ç”¨ Core Graphics å’Œ Cocoa Drawing åˆ›å»ºå’Œç»˜åˆ¶è·¯å¾„ï¼›</li>
<li>å¦‚ä½•å‰ªåˆ‡ä¸€ä¸ªåŒºåŸŸï¼›</li>
<li>å¦‚ä½•ç»˜åˆ¶æ–‡æœ¬ä¸²ï¼›</li>
<li>å¦‚ä½•ç»˜åˆ¶æ¸å˜ã€‚</li>
</ul>
<p>ä¹‹åçš„æ—¥å­é‡Œï¼Œå½“ä½ éœ€è¦åˆ›å»ºä¸€äº›æ•´æ´ã€ä¼˜ç¾çš„ç”¨æˆ·ç•Œé¢çš„æ—¶å€™ï¼Œä½ åº”è¯¥èƒ½è‡ªä¿¡åœ°æ‹¿å‡º Core Graphics å’Œ Cocoa Drawing æŒ¥æ´’åˆ›æ„äº†ã€‚</p>
<p>å¦‚æœä½ è¿˜æƒ³ç»§ç»­æ·±å…¥ï¼Œå¯ä»¥å‚è€ƒè¿™äº›èµ„æºï¼š</p>
<ul>
<li>Apple çš„ <a href="https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CocoaDrawingGuide/Introduction/Introduction.html" target="_blank" rel="noopener">Introduction to Cocoa Drawing Guide</a></li>
<li>Apple çš„ <a href="https://developer.apple.com/library/mac/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/Introduction/Introduction.html" target="_blank" rel="noopener">Quartz 2D Programming Guide</a></li>
</ul>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/blog/">é¦–é¡µ</a></li>
         
          <li><a href="/blog/archives/">å½’æ¡£</a></li>
         
          <li><a href="https://sr2k.top">ç®€å†</a></li>
         
          <li><a href="http://github.com/SR2k">é¡¹ç›®</a></li>
         
          <li><a href="/blog/tags/">tags</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#å‡†å¤‡å¼€å§‹"><span class="toc-number">1.</span> <span class="toc-text">å‡†å¤‡å¼€å§‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰è§†å›¾"><span class="toc-number">2.</span> <span class="toc-text">åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰è§†å›¾</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#åˆ›å»º-NSView-çš„å­ç±»"><span class="toc-number">2.1.</span> <span class="toc-text">åˆ›å»º NSView çš„å­ç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é‡å†™-draw"><span class="toc-number">2.2.</span> <span class="toc-text">é‡å†™ draw(_:)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å®æ—¶æ¸²æŸ“é¢„è§ˆï¼š-IBDesignable-å’Œ-IBInspectable"><span class="toc-number">3.</span> <span class="toc-text">å®æ—¶æ¸²æŸ“é¢„è§ˆï¼š@IBDesignable å’Œ @IBInspectable</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Graphics-Contextï¼ˆå›¾å½¢ä¸Šä¸‹æ–‡ï¼‰"><span class="toc-number">4.</span> <span class="toc-text">Graphics Contextï¼ˆå›¾å½¢ä¸Šä¸‹æ–‡ï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ç»˜åˆ¶è·¯å¾„"><span class="toc-number">5.</span> <span class="toc-text">ç»˜åˆ¶è·¯å¾„</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸ºé¥¼å›¾â€¦ç»˜åˆ¶ä¸€ä¸ªè·¯å¾„"><span class="toc-number">5.1.</span> <span class="toc-text">ä¸ºé¥¼å›¾â€¦ç»˜åˆ¶ä¸€ä¸ªè·¯å¾„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è®¡ç®—ä½ç½®"><span class="toc-number">5.2.</span> <span class="toc-text">è®¡ç®—ä½ç½®</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å‰ªåˆ‡ä¸€éƒ¨åˆ†åŒºåŸŸï¼ˆä¹Ÿå°±æ˜¯è’™ç‰ˆï¼‰"><span class="toc-number">6.</span> <span class="toc-text">å‰ªåˆ‡ä¸€éƒ¨åˆ†åŒºåŸŸï¼ˆä¹Ÿå°±æ˜¯è’™ç‰ˆï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ç»˜åˆ¶æ–‡æœ¬"><span class="toc-number">6.1.</span> <span class="toc-text">ç»˜åˆ¶æ–‡æœ¬</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cocoa-Drawing"><span class="toc-number">7.</span> <span class="toc-text">Cocoa Drawing</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ç»˜åˆ¶æ¸å˜"><span class="toc-number">7.1.</span> <span class="toc-text">ç»˜åˆ¶æ¸å˜</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ç»ƒä¹ -æŒ‘æˆ˜ï¼šç»˜åˆ¶é¥¼å›¾çš„å›¾ä¾‹"><span class="toc-number">8.</span> <span class="toc-text">ç»ƒä¹ /æŒ‘æˆ˜ï¼šç»˜åˆ¶é¥¼å›¾çš„å›¾ä¾‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ç­”æ¡ˆï¼šç»˜åˆ¶å›¾ä¾‹"><span class="toc-number">9.</span> <span class="toc-text">ç­”æ¡ˆï¼šç»˜åˆ¶å›¾ä¾‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ¥ä¸‹æ¥è¯¥åšå•¥ï¼Ÿ"><span class="toc-number">10.</span> <span class="toc-text">æ¥ä¸‹æ¥è¯¥åšå•¥ï¼Ÿ</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&text=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&title=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&is_video=false&description=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹&body=Check out this article: https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&title=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&title=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&title=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&title=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://sr2k.top/blog/2017/09/25/è¯‘-macOSä¸Šçš„CoreGraphicså…¥é—¨æ•™ç¨‹/&name=ã€è¯‘ã€‘macOS ä¸Šçš„ Core Graphics å…¥é—¨æ•™ç¨‹&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> èœå•</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> ç›®å½•</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> åˆ†äº«</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> è¿”å›é¡¶éƒ¨</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 Siyuan Cao
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/blog/">é¦–é¡µ</a></li>
         
          <li><a href="/blog/archives/">å½’æ¡£</a></li>
         
          <li><a href="https://sr2k.top">ç®€å†</a></li>
         
          <li><a href="http://github.com/SR2k">é¡¹ç›®</a></li>
         
          <li><a href="/blog/tags/">tags</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/blog/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/blog/lib/jquery/jquery.min.js"></script>
<script src="/blog/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<!-- clipboard -->

  <script src="/blog/lib/clipboard/clipboard.min.js"></script>
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"å¤åˆ¶åˆ°ç²˜è´´æ¿!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "å¤åˆ¶æˆåŠŸ!");
      e.clearSelection();
    })
  })
  </script>

<script src="/blog/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-90173601-3', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
